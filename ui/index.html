<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'">
  <title>Hivemind</title>
  <link rel="stylesheet" href="node_modules/@xterm/xterm/css/xterm.css">
  <link rel="stylesheet" href="styles/base.css">
  <link rel="stylesheet" href="styles/layout.css">
  <link rel="stylesheet" href="styles/panes.css">
  <link rel="stylesheet" href="styles/state-bar.css">
  <link rel="stylesheet" href="styles/settings-panel.css">
  <link rel="stylesheet" href="styles/friction-panel.css">
  <link rel="stylesheet" href="styles/tabs.css">
  <link rel="stylesheet" href="styles/sdk-renderer.css">
</head>
<body>
  <!-- Command Palette (Ctrl+K) -->
  <div class="command-palette-overlay" id="commandPaletteOverlay">
    <div class="command-palette" id="commandPalette">
      <input type="text" class="command-palette-input" id="commandPaletteInput"
             placeholder="Type a command..." autocomplete="off" spellcheck="false">
      <div class="command-palette-list" id="commandPaletteList"></div>
      <div class="command-palette-footer">
        <span class="shortcut"><kbd>‚Üë</kbd><kbd>‚Üì</kbd> Navigate</span>
        <span class="shortcut">Enter Select</span>
        <span class="shortcut">Esc Close</span>
      </div>
    </div>
  </div>

  <div class="header">
    <h1>Hivemind</h1>
    <span class="dry-run-indicator" id="dryRunIndicator" style="display: none;">DRY RUN</span>
    <div class="ci-status-indicator idle" id="ciStatusIndicator" style="display: none;">
      <span class="ci-status-icon" id="ciStatusIcon">-</span>
      <span class="ci-status-text" id="ciStatusText">CI Idle</span>
    </div>
    <!-- MC7: MCP Status Indicator -->
    <div class="mcp-status-indicator" id="mcpStatusIndicator" title="MCP connection status per agent">
      <span class="mcp-status-label">MCP</span>
      <div class="mcp-agent-dots">
        <div class="mcp-agent-dot disconnected" id="mcpDot1" data-pane="1" data-agent="Arch" title="Architect - Disconnected"></div>
        <div class="mcp-agent-dot disconnected" id="mcpDot2" data-pane="2" data-agent="Infra" title="Infra - Disconnected"></div>
        <div class="mcp-agent-dot disconnected" id="mcpDot3" data-pane="3" data-agent="Front" title="Frontend - Disconnected"></div>
        <div class="mcp-agent-dot disconnected" id="mcpDot4" data-pane="4" data-agent="Back" title="Backend - Disconnected"></div>
        <div class="mcp-agent-dot disconnected" id="mcpDot5" data-pane="5" data-agent="Anly" title="Analyst - Disconnected"></div>
        <div class="mcp-agent-dot disconnected" id="mcpDot6" data-pane="6" data-agent="Rev" title="Reviewer - Disconnected"></div>
      </div>
      <span class="mcp-status-summary none" id="mcpStatusSummary">0/6</span>
    </div>
    <div class="header-actions">
      <button class="btn btn-folder" id="selectProjectBtn" title="Choose project folder for all agents"><svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/></svg> Project</button>
      <button class="btn btn-spawn" id="spawnAllBtn" title="Start agent CLIs in all 6 terminal panes"><svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg> Spawn</button>
      <button class="btn btn-sync" id="syncBtn" title="Broadcast shared_context.md to all agents"><svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg> Sync</button>
      <div class="dropdown" id="actionsDropdown">
        <button class="btn btn-actions" id="actionsBtn" title="Agent management actions"><svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1"/><circle cx="19" cy="12" r="1"/><circle cx="5" cy="12" r="1"/></svg> Actions <svg class="dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg></button>
        <div class="dropdown-menu" id="actionsMenu">
          <button class="dropdown-item btn-nudge" id="nudgeAllBtn" title="Send Esc+Enter to unstick churning agents"><svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg> Nudge All</button>
          <button class="dropdown-item btn-danger" id="killAllBtn" title="Terminate all running agent sessions"><svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg> Kill All</button>
          <button class="dropdown-item btn-fresh" id="freshStartBtn" title="Kill all sessions and start fresh without context"><svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 1 1-8 0 4 4 0 0 1 8 0z"/></svg> Fresh Start</button>
          <div class="dropdown-divider"></div>
          <button class="dropdown-item btn-restart" id="fullRestartBtn" title="Shutdown cleanly (run 'npm start' to restart)"><svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18.36 6.64a9 9 0 1 1-12.73 0"/><line x1="12" y1="2" x2="12" y2="12"/></svg> Shutdown</button>
        </div>
      </div>
      <span class="cost-alert-badge" id="costAlertBadge" title="Cost threshold exceeded - click to view"><svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg> Cost</span>
      <button class="btn settings-btn" id="settingsBtn" title="Configure Hivemind settings and permissions"><svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg> Settings</button>
      <button class="btn btn-panel" id="panelBtn" title="Toggle right panel (Screenshots, Tests, Activity, etc.)"><svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><line x1="15" y1="3" x2="15" y2="21"/></svg> Panel</button>
    </div>
  </div>

  <div class="settings-panel" id="settingsPanel">
    <div class="settings-section">
      <div class="settings-section-title">General</div>
      <div class="settings-grid">
        <div class="setting-item" title="Automatically start agents in all panes when Hivemind launches">
          <div class="toggle" id="toggleAutoSpawn" data-setting="autoSpawn"></div>
          <span class="setting-label">Auto-spawn agents on start</span>
        </div>
        <div class="setting-item" title="Broadcast context updates to agents when workflow state changes">
          <div class="toggle" id="toggleAutoSync" data-setting="autoSync"></div>
          <span class="setting-label">Auto-sync context on state change</span>
        </div>
        <div class="setting-item" title="Play sound when agents complete tasks or encounter errors">
          <div class="toggle" id="toggleNotifications" data-setting="notifications"></div>
          <span class="setting-label">Sound notifications</span>
        </div>
        <div class="setting-item" title="Open Chrome DevTools when Hivemind starts (for debugging)">
          <div class="toggle" id="toggleDevTools" data-setting="devTools"></div>
          <span class="setting-label">Open DevTools on start</span>
        </div>
        <div class="setting-item" title="Send sync messages to agents when workflow state changes">
          <div class="toggle active" id="toggleAgentNotify" data-setting="agentNotify"></div>
          <span class="setting-label">Notify agents on state change</span>
        </div>
        <div class="setting-item" title="Watch for file changes in workspace (triggers, context updates)">
          <div class="toggle active" id="toggleWatcher" data-setting="watcherEnabled"></div>
          <span class="setting-label">File watcher enabled</span>
        </div>
        <div class="setting-item" title="Simulate agent responses without spawning real agent instances">
          <div class="toggle" id="toggleDryRun" data-setting="dryRun"></div>
          <span class="setting-label">Dry-run mode (simulate agents)</span>
        </div>
        <div class="setting-item" title="Automatically configure MCP server for each agent on spawn">
          <div class="toggle active" id="toggleMCPAutoConfig" data-setting="mcpAutoConfig"></div>
          <span class="setting-label">Auto-configure MCP on spawn</span>
        </div>
        <div class="setting-item" title="Use Claude Agent SDK instead of PTY terminals (experimental, 4 Claude sessions)">
          <div class="toggle" id="toggleSdkMode" data-setting="sdkMode"></div>
          <span class="setting-label">SDK Mode (experimental)</span>
        </div>
      </div>
      <div class="sdk-mode-notice" id="sdkModeNotice" style="display: none; color: #4ecca3; padding: 8px 12px; background: rgba(78, 204, 163, 0.1); border-radius: 4px; margin-top: 8px;">
        üöÄ SDK Mode: Uses Claude Agent SDK (4 Claude sessions) for native orchestration.
      </div>
    </div>

    <div class="settings-section">
      <div class="settings-section-title">Voice Control</div>
      <div class="settings-grid">
        <div class="setting-item" title="Enable speech-to-text for the command bar">
          <div class="toggle" id="toggleVoiceInputEnabled" data-setting="voiceInputEnabled"></div>
          <span class="setting-label">Voice input</span>
        </div>
        <div class="setting-item" title="Auto-send dictation when you stop listening">
          <div class="toggle" id="toggleVoiceAutoSend" data-setting="voiceAutoSend"></div>
          <span class="setting-label">Auto-send dictation</span>
        </div>
      </div>
      <div class="settings-subgrid">
        <div class="setting-field">
          <label class="setting-label">Voice language</label>
          <input type="text" class="settings-input" data-setting="voiceLanguage" placeholder="en-US" spellcheck="false">
        </div>
      </div>
    </div>

    <div class="settings-section">
      <div class="settings-section-title">Permissions</div>
      <div class="settings-grid">
        <div class="setting-item" title="Grant all permissions without prompting (use with caution!)">
          <div class="toggle" id="toggleAllowAllPermissions" data-setting="allowAllPermissions"></div>
          <span class="setting-label">Allow All (skip prompts)</span>
        </div>
        <div class="setting-item" title="Allow agents to read files from the filesystem">
          <div class="toggle" id="toggleAllowRead" data-setting="allowRead"></div>
          <span class="setting-label">Read files</span>
        </div>
        <div class="setting-item" title="Allow agents to create and modify files">
          <div class="toggle" id="toggleAllowWrite" data-setting="allowWrite"></div>
          <span class="setting-label">Write files</span>
        </div>
        <div class="setting-item" title="Allow agents to execute shell commands (npm, git, etc.)">
          <div class="toggle" id="toggleAllowBash" data-setting="allowBash"></div>
          <span class="setting-label">Run commands</span>
        </div>
      </div>
      <div class="permissions-warning" id="permissionsWarning" style="display: none;">
        ‚ö†Ô∏è "Allow All" grants full access. Only use for trusted projects.
      </div>
    </div>
    <div class="settings-section">
      <div class="settings-section-title">Cost Alerts</div>
      <div class="settings-grid">
        <div class="setting-item" title="Show warning when estimated session cost exceeds threshold">
          <div class="toggle active" id="toggleCostAlertEnabled" data-setting="costAlertEnabled"></div>
          <span class="setting-label">Enable cost alerts</span>
        </div>
      </div>
      <div class="cost-threshold-setting" title="Dollar amount that triggers a cost warning">
        <label class="setting-label">Alert threshold: $</label>
        <input type="number" id="costAlertThreshold" class="threshold-input" value="5.00" min="0.01" step="0.50" title="Estimated cost limit before warning">
      </div>
    </div>
    <div class="settings-section">
      <div class="settings-section-title">External Notifications</div>
      <div class="settings-grid">
        <div class="setting-item" title="Send external notifications for alerts and completions">
          <div class="toggle" id="toggleExternalNotificationsEnabled" data-setting="externalNotificationsEnabled"></div>
          <span class="setting-label">Enable external notifications</span>
        </div>
        <div class="setting-item" title="Send alerts (watchdog, cost, errors) to external channels">
          <div class="toggle" id="toggleNotifyOnAlerts" data-setting="notifyOnAlerts"></div>
          <span class="setting-label">Alerts</span>
        </div>
        <div class="setting-item" title="Send task completion notifications to external channels">
          <div class="toggle" id="toggleNotifyOnCompletions" data-setting="notifyOnCompletions"></div>
          <span class="setting-label">Task completions</span>
        </div>
      </div>
      <div class="settings-subgrid">
        <div class="setting-field">
          <label class="setting-label">Slack webhook</label>
          <input type="text" class="settings-input" data-setting="slackWebhookUrl" placeholder="https://hooks.slack.com/..." spellcheck="false">
        </div>
        <div class="setting-field">
          <label class="setting-label">Discord webhook</label>
          <input type="text" class="settings-input" data-setting="discordWebhookUrl" placeholder="https://discord.com/api/webhooks/..." spellcheck="false">
        </div>
      </div>
      <div class="settings-subgrid">
        <div class="setting-item" title="Send notifications via SMTP email">
          <div class="toggle" id="toggleEmailNotificationsEnabled" data-setting="emailNotificationsEnabled"></div>
          <span class="setting-label">Email notifications</span>
        </div>
        <div class="setting-item" title="Use SSL/TLS for SMTP (typically port 465)">
          <div class="toggle" id="toggleSmtpSecure" data-setting="smtpSecure"></div>
          <span class="setting-label">SMTP SSL/TLS</span>
        </div>
      </div>
      <div class="settings-subgrid settings-two-col">
        <div class="setting-field">
          <label class="setting-label">SMTP host</label>
          <input type="text" class="settings-input" data-setting="smtpHost" placeholder="smtp.example.com" spellcheck="false">
        </div>
        <div class="setting-field">
          <label class="setting-label">SMTP port</label>
          <input type="number" class="settings-input settings-input-short" data-setting="smtpPort" placeholder="587" min="1" step="1">
        </div>
        <div class="setting-field">
          <label class="setting-label">SMTP user</label>
          <input type="text" class="settings-input" data-setting="smtpUser" placeholder="user@example.com" spellcheck="false">
        </div>
        <div class="setting-field">
          <label class="setting-label">SMTP password</label>
          <input type="password" class="settings-input" data-setting="smtpPass" placeholder="app password">
        </div>
        <div class="setting-field">
          <label class="setting-label">From</label>
          <input type="text" class="settings-input" data-setting="smtpFrom" placeholder="alerts@example.com" spellcheck="false">
        </div>
        <div class="setting-field">
          <label class="setting-label">To</label>
          <input type="text" class="settings-input" data-setting="smtpTo" placeholder="you@example.com, team@example.com" spellcheck="false">
        </div>
      </div>
      <div class="settings-actions">
        <button class="btn btn-sm" id="sendExternalTestBtn" title="Send a test external notification">Send test</button>
      </div>
    </div>
  </div>

  <div class="friction-panel" id="frictionPanel">
    <div class="friction-header">
      <span class="friction-title" title="Issues and blockers reported by agents">Friction Logs</span>
      <div class="friction-actions">
        <button class="btn btn-friction" id="refreshFrictionBtn" title="Reload friction logs from workspace">Refresh</button>
        <button class="btn btn-friction" id="clearFrictionBtn" title="Delete all resolved friction logs">Clear Resolved</button>
      </div>
    </div>
    <div class="friction-list" id="frictionList">
      <div class="friction-empty">No friction logs found</div>
    </div>
  </div>

  <div class="state-bar">
    <div class="project-indicator" title="Current project folder for all agents">
      <span class="state-label">Project:</span>
      <span class="project-path no-project" id="projectPath">No project selected</span>
    </div>
    <div class="state-indicator" title="Current workflow state: idle ‚Üí planning ‚Üí executing ‚Üí complete">
      <span class="state-label">State:</span>
      <span class="state-value idle" id="stateDisplay">IDLE</span>
    </div>
    <div class="progress-indicator" title="Checkpoint progress through current sprint">
      <span class="state-label">Progress:</span>
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
      </div>
      <span class="progress-text" id="progressText">0 / 0</span>
    </div>
  </div>

  <div class="main-content">
    <div class="terminals-section" id="terminalsSection">
      <div class="pane-layout">
        <div class="main-pane-container">
          <div class="pane" data-pane-id="1">
          <div class="pane-header">
            <span class="pane-title"><span class="agent-avatar">[A]</span><span class="agent-badge idle" id="badge-1"></span>Architect<span class="cli-badge" id="cli-badge-1"></span><span class="pane-project" id="project-1" title="Click to change project"></span><span class="agent-task" id="task-1"></span></span>
            <div class="pane-header-right">
              <span class="pane-timer" id="timer-1" title="Session time">0:00</span>
              <span class="sdk-status disconnected" id="sdk-status-1" title="SDK session status">‚Äî</span>
              <span class="sdk-session-id" id="sdk-session-1" title="Session ID"></span>
              <span class="pane-status idle" id="status-1"><span class="pane-spinner"></span>Ready</span>
              <span class="agent-health" id="health-1" title="Last output time">-</span>
              <span class="stuck-indicator" id="stuck-1" title="Agent may be stuck">!</span>
              <span class="delivery-indicator" id="delivery-1" title="Message delivery status"></span>
              <div class="pane-actions">
                <button class="pane-action-btn interrupt-btn" data-pane-id="1" title="Send Ctrl+C (interrupt)">X</button>
                <button class="pane-action-btn unstick-btn" data-pane-id="1" title="Send ESC (unstick)">~</button>
              </div>
              <button class="pane-refresh-btn" data-pane-id="1" title="Refresh context">R</button>
              <span class="lock-icon" id="lock-icon-1" data-pane-id="1" title="Input locked (click to unlock)">L</span>
            </div>
          </div>
          <div class="pane-terminal" id="terminal-1"></div>
          </div>
        </div>
        <div class="side-panes-container">
          <div class="pane" data-pane-id="2">
          <div class="pane-header">
            <span class="pane-title"><span class="agent-avatar">[I]</span><span class="agent-badge idle" id="badge-2"></span>Infra<span class="cli-badge" id="cli-badge-2"></span><span class="pane-project" id="project-2" title="Click to change project"></span><span class="agent-task" id="task-2"></span></span>
            <div class="pane-header-right">
              <span class="pane-timer" id="timer-2" title="Session time">0:00</span>
              <span class="sdk-status disconnected" id="sdk-status-2" title="SDK session status">‚Äî</span>
              <span class="sdk-session-id" id="sdk-session-2" title="Session ID"></span>
              <span class="pane-status idle" id="status-2"><span class="pane-spinner"></span>Ready</span>
              <span class="agent-health" id="health-2" title="Last output time">-</span>
              <span class="stuck-indicator" id="stuck-2" title="Agent may be stuck">!</span>
              <span class="delivery-indicator" id="delivery-2" title="Message delivery status"></span>
              <div class="pane-actions">
                <button class="pane-action-btn interrupt-btn" data-pane-id="2" title="Send Ctrl+C (interrupt)">X</button>
                <button class="pane-action-btn unstick-btn" data-pane-id="2" title="Send ESC (unstick)">~</button>
              </div>
              <button class="pane-refresh-btn" data-pane-id="2" title="Refresh context">R</button>
              <span class="lock-icon" id="lock-icon-2" data-pane-id="2" title="Input locked (click to unlock)">L</span>
            </div>
          </div>
          <div class="pane-terminal" id="terminal-2"></div>
        </div>

        <div class="pane" data-pane-id="3">
          <div class="pane-header">
            <span class="pane-title"><span class="agent-avatar">[F]</span><span class="agent-badge idle" id="badge-3"></span>Frontend<span class="cli-badge" id="cli-badge-3"></span><span class="pane-project" id="project-3" title="Click to change project"></span><span class="agent-task" id="task-3"></span></span>
            <div class="pane-header-right">
              <span class="pane-timer" id="timer-3" title="Session time">0:00</span>
              <span class="sdk-status disconnected" id="sdk-status-3" title="SDK session status">‚Äî</span>
              <span class="sdk-session-id" id="sdk-session-3" title="Session ID"></span>
              <span class="pane-status idle" id="status-3"><span class="pane-spinner"></span>Ready</span>
              <span class="agent-health" id="health-3" title="Last output time">-</span>
              <span class="stuck-indicator" id="stuck-3" title="Agent may be stuck">!</span>
              <span class="delivery-indicator" id="delivery-3" title="Message delivery status"></span>
              <div class="pane-actions">
                <button class="pane-action-btn interrupt-btn" data-pane-id="3" title="Send Ctrl+C (interrupt)">X</button>
                <button class="pane-action-btn unstick-btn" data-pane-id="3" title="Send ESC (unstick)">~</button>
              </div>
              <button class="pane-refresh-btn" data-pane-id="3" title="Refresh context">R</button>
              <span class="lock-icon" id="lock-icon-3" data-pane-id="3" title="Input locked (click to unlock)">L</span>
            </div>
          </div>
          <div class="pane-terminal" id="terminal-3"></div>
        </div>

        <div class="pane" data-pane-id="4">
          <div class="pane-header">
            <span class="pane-title"><span class="agent-avatar">[B]</span><span class="agent-badge idle" id="badge-4"></span>Backend<span class="cli-badge" id="cli-badge-4"></span><span class="pane-project" id="project-4" title="Click to change project"></span><span class="agent-task" id="task-4"></span></span>
            <div class="pane-header-right">
              <span class="pane-timer" id="timer-4" title="Session time">0:00</span>
              <span class="sdk-status disconnected" id="sdk-status-4" title="SDK session status">‚Äî</span>
              <span class="sdk-session-id" id="sdk-session-4" title="Session ID"></span>
              <span class="pane-status idle" id="status-4"><span class="pane-spinner"></span>Ready</span>
              <span class="agent-health" id="health-4" title="Last output time">-</span>
              <span class="stuck-indicator" id="stuck-4" title="Agent may be stuck">!</span>
              <span class="delivery-indicator" id="delivery-4" title="Message delivery status"></span>
              <div class="pane-actions">
                <button class="pane-action-btn interrupt-btn" data-pane-id="4" title="Send Ctrl+C (interrupt)">X</button>
                <button class="pane-action-btn unstick-btn" data-pane-id="4" title="Send ESC (unstick)">~</button>
              </div>
              <button class="pane-refresh-btn" data-pane-id="4" title="Refresh context">R</button>
              <span class="lock-icon" id="lock-icon-4" data-pane-id="4" title="Input locked (click to unlock)">L</span>
            </div>
          </div>
          <div class="pane-terminal" id="terminal-4"></div>
        </div>

        <div class="pane" data-pane-id="5">
          <div class="pane-header">
            <span class="pane-title"><span class="agent-avatar">[?]</span><span class="agent-badge idle" id="badge-5"></span>Analyst<span class="cli-badge" id="cli-badge-5"></span><span class="pane-project" id="project-5" title="Click to change project"></span><span class="agent-task" id="task-5"></span></span>
            <div class="pane-header-right">
              <span class="pane-timer" id="timer-5" title="Session time">0:00</span>
              <span class="sdk-status disconnected" id="sdk-status-5" title="SDK session status">‚Äî</span>
              <span class="sdk-session-id" id="sdk-session-5" title="Session ID"></span>
              <span class="pane-status idle" id="status-5"><span class="pane-spinner"></span>Ready</span>
              <span class="agent-health" id="health-5" title="Last output time">-</span>
              <span class="stuck-indicator" id="stuck-5" title="Agent may be stuck">!</span>
              <span class="delivery-indicator" id="delivery-5" title="Message delivery status"></span>
              <div class="pane-actions">
                <button class="pane-action-btn interrupt-btn" data-pane-id="5" title="Send Ctrl+C (interrupt)">X</button>
                <button class="pane-action-btn unstick-btn" data-pane-id="5" title="Send ESC (unstick)">~</button>
              </div>
              <button class="pane-refresh-btn" data-pane-id="5" title="Refresh context">R</button>
              <span class="lock-icon" id="lock-icon-5" data-pane-id="5" title="Input locked (click to unlock)">L</span>
            </div>
          </div>
          <div class="pane-terminal" id="terminal-5"></div>
        </div>

        <div class="pane" data-pane-id="6">
          <div class="pane-header">
            <span class="pane-title"><span class="agent-avatar">[R]</span><span class="agent-badge idle" id="badge-6"></span>Reviewer<span class="cli-badge" id="cli-badge-6"></span><span class="pane-project" id="project-6" title="Click to change project"></span><span class="agent-task" id="task-6"></span></span>
            <div class="pane-header-right">
              <span class="pane-timer" id="timer-6" title="Session time">0:00</span>
              <span class="sdk-status disconnected" id="sdk-status-6" title="SDK session status">‚Äî</span>
              <span class="sdk-session-id" id="sdk-session-6" title="Session ID"></span>
              <span class="pane-status idle" id="status-6"><span class="pane-spinner"></span>Ready</span>
              <span class="agent-health" id="health-6" title="Last output time">-</span>
              <span class="stuck-indicator" id="stuck-6" title="Agent may be stuck">!</span>
              <span class="delivery-indicator" id="delivery-6" title="Message delivery status"></span>
              <div class="pane-actions">
                <button class="pane-action-btn interrupt-btn" data-pane-id="6" title="Send Ctrl+C (interrupt)">X</button>
                <button class="pane-action-btn unstick-btn" data-pane-id="6" title="Send ESC (unstick)">~</button>
              </div>
              <button class="pane-refresh-btn" data-pane-id="6" title="Refresh context">R</button>
              <span class="lock-icon" id="lock-icon-6" data-pane-id="6" title="Input locked (click to unlock)">L</span>
            </div>
          </div>
          <div class="pane-terminal" id="terminal-6"></div>
        </div>
        </div>
      </div>

      <!-- Command bar - full width at bottom -->
      <form class="command-bar" autocomplete="off" onsubmit="return false;">
        <div class="command-target-wrapper">
          <select class="command-target" id="commandTarget" title="Select message target">
            <option value="auto">Auto-route</option>
            <option value="1" selected>Architect</option>
            <option value="all">All Agents</option>
            <option value="2">Infra</option>
            <option value="3">Frontend</option>
            <option value="4">Backend</option>
            <option value="5">Analyst</option>
            <option value="6">Reviewer</option>
          </select>
        </div>
        <input type="text" class="command-input" id="broadcastInput"
               placeholder="Type here to message Architect (Enter to send)"
               title="Send message to selected target"
               autocomplete="new-password" autocorrect="off" autocapitalize="off"
               spellcheck="false" data-lpignore="true" data-form-type="other"
               data-1p-ignore="true" list=""
               name="broadcast-input-random-8472"
               readonly onfocus="this.removeAttribute('readonly');">
        <span class="command-delivery-status" id="commandDeliveryStatus" title="Message delivery status"></span>
        <button type="button" class="btn voice-btn" id="voiceInputBtn" title="Toggle voice input">Mic</button>
        <span class="voice-status" id="voiceStatus" title="Voice input status">Voice off</span>
        <button type="button" class="btn" id="broadcastBtn" title="Send message">Send</button>
      </form>
    </div>

    <div class="right-panel" id="rightPanel">
      <div class="panel-tabs">
        <button class="panel-tab active" data-tab="screenshots" title="Drag & drop images for agents to reference">Shots</button>
        <button class="panel-tab" data-tab="tests" title="View test results and run test suite">Tests</button>
        <button class="panel-tab" data-tab="activity" title="Real-time log of all agent activity">Activity</button>
        <button class="panel-tab" data-tab="queue" title="Task queue, message backlog, and conflict locks">Queue</button>
        <button class="panel-tab" data-tab="schedule" title="Scheduled tasks and automation">Sched</button>
        <button class="panel-tab" data-tab="friction" title="Agent friction logs and blockers"><span id="frictionTabBadge" class="tab-badge hidden">0</span>Friction</button>
        <button class="panel-tab" data-tab="inspector" title="Debug message flow and delivery">Insp</button>
        <button class="panel-tab" data-tab="history" title="View past session history">Hist</button>
        <button class="panel-tab" data-tab="memory" title="Agent conversation history and context">Mem</button>
        <button class="panel-tab" data-tab="health" title="Agent health monitoring and recovery controls">Health</button>
        <button class="panel-tab" data-tab="graph" title="Knowledge graph - relationships between files, agents, decisions">Graph</button>
        <button class="panel-tab" data-tab="workflow" title="Drag-and-drop workflow builder">Flow</button>
        <button class="panel-tab" data-tab="debug" title="Agent action replay and debugging">Debug</button>
        <button class="panel-tab" data-tab="review" title="AI-powered code review and suggestions">Review</button>
        <button class="panel-tab" data-tab="docs" title="Auto-generate documentation from code">Docs</button>
        <button class="panel-tab" data-tab="costs" title="API cost tracking, predictions, and optimization">Costs</button>
        <button class="panel-tab" data-tab="security" title="Authentication, encryption, and access control">Sec</button>
        <button class="panel-tab" data-tab="dashboard" title="Multi-project dashboard with metrics and health scores">Dash</button>
        <button class="panel-tab" data-tab="projects" title="Quick-switch between recent projects">Proj</button>
        <button class="panel-tab" data-tab="git" title="Repository status, diffs, and commits">Git</button>
        <button class="panel-tab" data-tab="performance" title="Agent performance metrics and stats">Perf</button>
        <button class="panel-tab" data-tab="templates" title="Save and load workspace configurations">Tmpl</button>
        <button class="panel-tab" data-tab="scaffold" title="Create new projects from templates">Scaf</button>
        <button class="panel-tab" data-tab="deploy" title="Build automation and deployment pipeline">Dep</button>
        <button class="panel-tab" data-tab="collab" title="Real-time collaboration and shared sessions">Collab</button>
        <button class="panel-tab" data-tab="mobile" title="Mobile app connection and remote monitoring">Mobile</button>
        <button class="panel-tab" data-tab="progress" title="Build progress and usage statistics">Prog</button>
        <button class="panel-tab" data-tab="processes" title="Manage background processes">Proc</button>
      </div>
      <div class="panel-content">
        <div class="tab-pane active" id="tab-screenshots">
          <div class="tab-title">Screenshots</div>
          <div class="tab-description">Drag & drop images or paste from clipboard</div>
          <div class="screenshot-dropzone" id="screenshotDropzone">
            <div class="screenshot-dropzone-icon">üì∑</div>
            <div class="screenshot-dropzone-text">Drop images here or click to browse</div>
          </div>
          <div class="screenshot-list" id="screenshotList">
            <div class="screenshot-empty">No screenshots yet</div>
          </div>
        </div>
        <div class="tab-pane" id="tab-tests">
          <div class="tab-title">Test Results</div>
          <div class="tab-description">View test execution results and failures</div>
          <div class="test-status-badge idle" id="testStatusBadge">No tests run</div>
          <div class="test-summary" id="testSummary">
            <div class="test-summary-card passed">
              <div class="test-summary-value" id="testPassedCount">0</div>
              <div class="test-summary-label">Passed</div>
            </div>
            <div class="test-summary-card failed">
              <div class="test-summary-value" id="testFailedCount">0</div>
              <div class="test-summary-label">Failed</div>
            </div>
            <div class="test-summary-card skipped">
              <div class="test-summary-value" id="testSkippedCount">0</div>
              <div class="test-summary-label">Skipped</div>
            </div>
          </div>
          <div class="test-progress-bar">
            <div class="test-progress-fill" id="testProgressFill">
              <div class="test-progress-passed" id="testProgressPassed" style="width: 0%"></div>
              <div class="test-progress-failed" id="testProgressFailed" style="width: 0%"></div>
              <div class="test-progress-skipped" id="testProgressSkipped" style="width: 0%"></div>
            </div>
          </div>
          <div class="test-results-list" id="testResultsList">
            <div class="test-empty">No test results yet. Run tests to see results here.</div>
          </div>
          <div class="test-actions">
            <button class="btn btn-test" id="runTestsBtn" title="Execute test suite for current project">Run Tests</button>
            <button class="btn" id="refreshTestsBtn" title="Reload test results from last run">Refresh</button>
            <button class="btn" id="clearTestsBtn" title="Clear all test results">Clear</button>
          </div>
        </div>
        <div class="tab-pane" id="tab-activity">
          <div class="tab-title">Activity Log</div>
          <div class="tab-description">Real-time agent activity and events</div>
          <div class="activity-controls">
            <div class="activity-filters">
              <button class="activity-filter active" data-filter="all">All</button>
              <button class="activity-filter" data-filter="error">Errors</button>
              <button class="activity-filter" data-filter="file" title="Show file change events">Files</button>
              <button class="activity-filter" data-filter="state" title="Show state transition events">State</button>
            </div>
            <input type="text" class="activity-search" id="activitySearch" placeholder="Search..." title="Filter activity by text" autocomplete="off">
          </div>
          <div class="activity-log" id="activityLog">
            <div class="activity-empty">No activity yet</div>
          </div>
          <div class="activity-actions">
            <button class="btn" id="clearActivityBtn" title="Clear all activity entries">Clear</button>
            <button class="btn" id="exportActivityBtn" title="Download activity log as text file">Export</button>
          </div>
        </div>
        <div class="tab-pane" id="tab-queue">
          <div class="tab-title">Task Queue</div>
          <div class="tab-description">Message backlog, conflict locks, and active claims</div>
          <div class="queue-summary" id="queueSummary">
            <div class="queue-card">
              <div class="queue-card-label">Queued</div>
              <div class="queue-card-value" id="queueTotalCount">0</div>
            </div>
            <div class="queue-card warning">
              <div class="queue-card-label">Undelivered</div>
              <div class="queue-card-value" id="queueUndeliveredCount">0</div>
            </div>
            <div class="queue-card info">
              <div class="queue-card-label">Locks</div>
              <div class="queue-card-value" id="queueLockCount">0</div>
            </div>
            <div class="queue-card accent">
              <div class="queue-card-label">Queued Files</div>
              <div class="queue-card-value" id="queueFileCount">0</div>
            </div>
          </div>
          <div class="queue-grid">
            <div class="queue-panel">
              <div class="queue-panel-title">Message Queue</div>
              <div class="queue-pane-list" id="queuePaneList">
                <div class="queue-empty">No queued messages</div>
              </div>
            </div>
            <div class="queue-panel">
              <div class="queue-panel-title">Conflict Queue</div>
              <div class="queue-conflict-list" id="queueConflictList">
                <div class="queue-empty">No active file locks</div>
              </div>
            </div>
          </div>
          <div class="queue-claims">
            <div class="queue-panel-title">Active Claims</div>
            <div class="queue-claims-list" id="queueClaimsList">
              <div class="queue-empty">No active claims</div>
            </div>
          </div>
          <div class="queue-events">
            <div class="queue-panel-title">Queue Events</div>
            <div class="queue-events-list" id="queueEventsList">
              <div class="queue-empty">No queue events</div>
            </div>
          </div>
          <div class="queue-actions">
            <button class="btn" id="refreshQueueBtn" title="Reload queue status">Refresh</button>
            <button class="btn" id="clearDeliveredQueueBtn" title="Clear delivered messages from queues">Clear Delivered</button>
          </div>
        </div>
        <div class="tab-pane" id="tab-schedule">
          <div class="tab-title">Schedule</div>
          <div class="tab-description">Cron-like task automation and chains</div>
          <div class="schedule-form">
            <input type="text" id="scheduleInput" class="schedule-input" placeholder="Describe a task to schedule..." autocomplete="off">
            <div class="schedule-row">
              <select id="scheduleType" class="schedule-select">
                <option value="once">Once</option>
                <option value="interval">Interval</option>
                <option value="cron">Cron</option>
                <option value="event">Event</option>
              </select>
              <input type="datetime-local" id="scheduleTime" class="schedule-time">
              <input type="number" id="scheduleInterval" class="schedule-interval" min="1" placeholder="Minutes" style="display:none;">
              <input type="text" id="scheduleCron" class="schedule-cron" placeholder="*/15 * * * *" style="display:none;">
              <input type="text" id="scheduleEvent" class="schedule-event" placeholder="event.name" style="display:none;">
              <input type="text" id="scheduleTimezone" class="schedule-timezone" placeholder="Local tz (e.g., America/Los_Angeles)">
              <button class="btn btn-secondary" id="scheduleAddBtn">Add</button>
            </div>
          </div>
          <div class="schedule-calendar" id="scheduleCalendar"></div>
          <div class="schedule-list" id="scheduleList">
            <div class="schedule-empty">No scheduled tasks</div>
          </div>
        </div>
        <div class="tab-pane" id="tab-friction">
          <div class="tab-title">Friction Logs</div>
          <div class="tab-description">Issues and blockers reported by agents</div>
          <div class="friction-list" id="frictionListTab">
            <div class="friction-empty">No friction logs found</div>
          </div>
          <div class="friction-actions-tab">
            <button class="btn" id="refreshFrictionTabBtn" title="Reload friction logs from workspace">Refresh</button>
            <button class="btn" id="clearFrictionTabBtn" title="Delete all resolved friction logs">Clear Resolved</button>
          </div>
        </div>
        <div class="tab-pane" id="tab-history">
          <div class="tab-title">Session History</div>
          <div class="tab-description">Past agent sessions and their durations</div>
          <div class="history-list" id="historyList">
            <div class="history-empty">No sessions recorded yet</div>
          </div>
          <div class="history-actions">
            <button class="btn" id="refreshHistoryBtn" title="Reload session history">Refresh</button>
          </div>
        </div>
        <div class="tab-pane" id="tab-memory">
          <div class="tab-title">Agent Memory</div>
          <div class="tab-description">Conversation history, context, and learnings</div>
          <div class="memory-controls">
            <select id="memoryAgentSelect" class="memory-agent-select">
              <option value="all">All Agents</option>
              <option value="1">Architect</option>
              <option value="2">Infra</option>
              <option value="3">Frontend</option>
              <option value="4">Backend</option>
              <option value="5">Analyst</option>
              <option value="6">Reviewer</option>
            </select>
            <input type="text" id="memorySearchInput" class="memory-search-input" placeholder="Search conversations..." />
            <button class="btn btn-sm" id="memorySearchBtn" title="Search">üîç</button>
          </div>
            <div class="memory-view-tabs">
              <button class="memory-view-tab active" data-view="transcript">Transcript</button>
              <button class="memory-view-tab" data-view="timeline">Timeline</button>
              <button class="memory-view-tab" data-view="context">Context</button>
              <button class="memory-view-tab" data-view="learnings">Learnings</button>
              <button class="memory-view-tab" data-view="team">Team</button>
            </div>
            <div class="memory-content" id="memoryContent">
              <div class="memory-view active" id="memory-transcript">
                <div class="transcript-list" id="transcriptList">
                  <div class="memory-empty">Select an agent to view conversation history</div>
                </div>
              </div>
              <div class="memory-view" id="memory-timeline">
                <div class="memory-timeline" id="memoryTimeline">
                  <div class="memory-empty">Select an agent to view timeline</div>
                </div>
              </div>
              <div class="memory-view" id="memory-context">
                <div class="context-summary" id="contextSummary">
                  <div class="memory-empty">Select an agent to view context</div>
                </div>
              </div>
            <div class="memory-view" id="memory-learnings">
              <div class="learnings-list" id="learningsList">
                <div class="memory-empty">No learnings recorded</div>
              </div>
            </div>
            <div class="memory-view" id="memory-team">
              <div class="team-summary" id="teamSummary">
                <div class="memory-empty">Loading team summary...</div>
              </div>
            </div>
          </div>
          <div class="memory-actions">
            <button class="btn btn-sm" id="memoryRefreshBtn" title="Refresh memory data">Refresh</button>
            <button class="btn btn-sm" id="memoryClearBtn" title="Clear search">Clear</button>
            <span class="memory-stats" id="memoryStats"></span>
          </div>
        </div>
        <div class="tab-pane" id="tab-health">
          <div class="tab-title">Agent Health</div>
          <div class="tab-description">Monitor agent status and trigger recovery actions</div>

            <!-- Overall health summary -->
            <div class="health-overview" id="healthOverview">
            <div class="health-summary-card healthy">
              <div class="health-summary-value" id="healthyAgentCount">0</div>
              <div class="health-summary-label">Healthy</div>
            </div>

            <!-- Resource usage overview -->
            <div class="resource-overview" id="resourceOverview">
              <div class="resource-card">
                <div class="resource-label">CPU</div>
                <div class="resource-value" id="resourceCpu">--</div>
                <div class="resource-sub" id="resourceCpuDetail">System load</div>
              </div>
              <div class="resource-card">
                <div class="resource-label">Memory</div>
                <div class="resource-value" id="resourceMem">--</div>
                <div class="resource-sub" id="resourceMemDetail">Used / Total</div>
              </div>
              <div class="resource-card">
                <div class="resource-label">Disk</div>
                <div class="resource-value" id="resourceDisk">--</div>
                <div class="resource-sub" id="resourceDiskDetail">Workspace</div>
              </div>
            </div>
            <div class="resource-bottlenecks" id="resourceBottlenecks"></div>
            <div class="health-summary-card warning">
              <div class="health-summary-value" id="warningAgentCount">0</div>
              <div class="health-summary-label">Warning</div>
            </div>
            <div class="health-summary-card error">
              <div class="health-summary-value" id="errorAgentCount">0</div>
              <div class="health-summary-label">Error</div>
            </div>
            <div class="health-summary-card recovering">
              <div class="health-summary-value" id="recoveringAgentCount">0</div>
              <div class="health-summary-label">Recovering</div>
            </div>
          </div>

          <!-- Agent health list -->
          <div class="health-agent-list" id="healthAgentList">
              <div class="health-agent-item" data-pane="1">
              <div class="health-agent-header">
                <span class="health-agent-badge" id="health-badge-1">‚óè</span>
                <span class="health-agent-name">Architect</span>
                <span class="health-agent-status" id="health-status-1">Unknown</span>
              </div>
                <div class="health-agent-details">
                  <div class="health-metric">
                    <span class="health-metric-label">Last Output:</span>
                    <span class="health-metric-value" id="health-last-output-1">-</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">Stuck Count:</span>
                    <span class="health-metric-value" id="health-stuck-count-1">0</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">Recovery Step:</span>
                    <span class="health-metric-value" id="health-recovery-step-1">None</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">CPU:</span>
                    <span class="health-metric-value" id="health-cpu-1">-</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">Mem:</span>
                    <span class="health-metric-value" id="health-mem-1">-</span>
                  </div>
                </div>
              <div class="health-agent-actions">
                <button class="btn btn-sm btn-nudge" data-action="nudge" data-pane="1" title="Send Enter to unstick">Nudge</button>
                <button class="btn btn-sm btn-interrupt" data-action="interrupt" data-pane="1" title="Send Ctrl+C interrupt">Interrupt</button>
                <button class="btn btn-sm btn-restart" data-action="restart" data-pane="1" title="Kill and restart agent">Restart</button>
              </div>
            </div>
              <div class="health-agent-item" data-pane="2">
              <div class="health-agent-header">
                <span class="health-agent-badge" id="health-badge-2">‚óè</span>
                <span class="health-agent-name">Infra</span>
                <span class="health-agent-status" id="health-status-2">Unknown</span>
              </div>
                <div class="health-agent-details">
                  <div class="health-metric">
                    <span class="health-metric-label">Last Output:</span>
                    <span class="health-metric-value" id="health-last-output-2">-</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">Stuck Count:</span>
                    <span class="health-metric-value" id="health-stuck-count-2">0</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">Recovery Step:</span>
                    <span class="health-metric-value" id="health-recovery-step-2">None</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">CPU:</span>
                    <span class="health-metric-value" id="health-cpu-2">-</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">Mem:</span>
                    <span class="health-metric-value" id="health-mem-2">-</span>
                  </div>
                </div>
              <div class="health-agent-actions">
                <button class="btn btn-sm btn-nudge" data-action="nudge" data-pane="2" title="Send Enter to unstick">Nudge</button>
                <button class="btn btn-sm btn-interrupt" data-action="interrupt" data-pane="2" title="Send Ctrl+C interrupt">Interrupt</button>
                <button class="btn btn-sm btn-restart" data-action="restart" data-pane="2" title="Kill and restart agent">Restart</button>
              </div>
            </div>
              <div class="health-agent-item" data-pane="3">
              <div class="health-agent-header">
                <span class="health-agent-badge" id="health-badge-3">‚óè</span>
                <span class="health-agent-name">Frontend</span>
                <span class="health-agent-status" id="health-status-3">Unknown</span>
              </div>
                <div class="health-agent-details">
                  <div class="health-metric">
                    <span class="health-metric-label">Last Output:</span>
                    <span class="health-metric-value" id="health-last-output-3">-</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">Stuck Count:</span>
                    <span class="health-metric-value" id="health-stuck-count-3">0</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">Recovery Step:</span>
                    <span class="health-metric-value" id="health-recovery-step-3">None</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">CPU:</span>
                    <span class="health-metric-value" id="health-cpu-3">-</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">Mem:</span>
                    <span class="health-metric-value" id="health-mem-3">-</span>
                  </div>
                </div>
              <div class="health-agent-actions">
                <button class="btn btn-sm btn-nudge" data-action="nudge" data-pane="3" title="Send Enter to unstick">Nudge</button>
                <button class="btn btn-sm btn-interrupt" data-action="interrupt" data-pane="3" title="Send Ctrl+C interrupt">Interrupt</button>
                <button class="btn btn-sm btn-restart" data-action="restart" data-pane="3" title="Kill and restart agent">Restart</button>
              </div>
            </div>
              <div class="health-agent-item" data-pane="4">
              <div class="health-agent-header">
                <span class="health-agent-badge" id="health-badge-4">‚óè</span>
                <span class="health-agent-name">Backend</span>
                <span class="health-agent-status" id="health-status-4">Unknown</span>
              </div>
                <div class="health-agent-details">
                  <div class="health-metric">
                    <span class="health-metric-label">Last Output:</span>
                    <span class="health-metric-value" id="health-last-output-4">-</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">Stuck Count:</span>
                    <span class="health-metric-value" id="health-stuck-count-4">0</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">Recovery Step:</span>
                    <span class="health-metric-value" id="health-recovery-step-4">None</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">CPU:</span>
                    <span class="health-metric-value" id="health-cpu-4">-</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">Mem:</span>
                    <span class="health-metric-value" id="health-mem-4">-</span>
                  </div>
                </div>
              <div class="health-agent-actions">
                <button class="btn btn-sm btn-nudge" data-action="nudge" data-pane="4" title="Send Enter to unstick">Nudge</button>
                <button class="btn btn-sm btn-interrupt" data-action="interrupt" data-pane="4" title="Send Ctrl+C interrupt">Interrupt</button>
                <button class="btn btn-sm btn-restart" data-action="restart" data-pane="4" title="Kill and restart agent">Restart</button>
              </div>
            </div>
              <div class="health-agent-item" data-pane="5">
              <div class="health-agent-header">
                <span class="health-agent-badge" id="health-badge-5">‚óè</span>
                <span class="health-agent-name">Analyst</span>
                <span class="health-agent-status" id="health-status-5">Unknown</span>
              </div>
                <div class="health-agent-details">
                  <div class="health-metric">
                    <span class="health-metric-label">Last Output:</span>
                    <span class="health-metric-value" id="health-last-output-5">-</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">Stuck Count:</span>
                    <span class="health-metric-value" id="health-stuck-count-5">0</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">Recovery Step:</span>
                    <span class="health-metric-value" id="health-recovery-step-5">None</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">CPU:</span>
                    <span class="health-metric-value" id="health-cpu-5">-</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">Mem:</span>
                    <span class="health-metric-value" id="health-mem-5">-</span>
                  </div>
                </div>
              <div class="health-agent-actions">
                <button class="btn btn-sm btn-nudge" data-action="nudge" data-pane="5" title="Send Enter to unstick">Nudge</button>
                <button class="btn btn-sm btn-interrupt" data-action="interrupt" data-pane="5" title="Send Ctrl+C interrupt">Interrupt</button>
                <button class="btn btn-sm btn-restart" data-action="restart" data-pane="5" title="Kill and restart agent">Restart</button>
              </div>
            </div>
              <div class="health-agent-item" data-pane="6">
              <div class="health-agent-header">
                <span class="health-agent-badge" id="health-badge-6">‚óè</span>
                <span class="health-agent-name">Reviewer</span>
                <span class="health-agent-status" id="health-status-6">Unknown</span>
              </div>
                <div class="health-agent-details">
                  <div class="health-metric">
                    <span class="health-metric-label">Last Output:</span>
                    <span class="health-metric-value" id="health-last-output-6">-</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">Stuck Count:</span>
                    <span class="health-metric-value" id="health-stuck-count-6">0</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">Recovery Step:</span>
                    <span class="health-metric-value" id="health-recovery-step-6">None</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">CPU:</span>
                    <span class="health-metric-value" id="health-cpu-6">-</span>
                  </div>
                  <div class="health-metric">
                    <span class="health-metric-label">Mem:</span>
                    <span class="health-metric-value" id="health-mem-6">-</span>
                  </div>
                </div>
              <div class="health-agent-actions">
                <button class="btn btn-sm btn-nudge" data-action="nudge" data-pane="6" title="Send Enter to unstick">Nudge</button>
                <button class="btn btn-sm btn-interrupt" data-action="interrupt" data-pane="6" title="Send Ctrl+C interrupt">Interrupt</button>
                <button class="btn btn-sm btn-restart" data-action="restart" data-pane="6" title="Kill and restart agent">Restart</button>
              </div>
            </div>
          </div>

          <!-- Active recovery playbook -->
          <div class="health-playbook" id="healthPlaybook">
            <div class="health-playbook-header">
              <span class="health-playbook-title">Active Recovery</span>
              <span class="health-playbook-status" id="playbookStatus">Idle</span>
            </div>
            <div class="health-playbook-steps" id="playbookSteps">
              <div class="playbook-step" data-step="nudge">
                <span class="playbook-step-icon">1</span>
                <span class="playbook-step-name">Nudge</span>
                <span class="playbook-step-desc">Send Enter to prompt response</span>
              </div>
              <div class="playbook-step" data-step="interrupt">
                <span class="playbook-step-icon">2</span>
                <span class="playbook-step-name">Interrupt</span>
                <span class="playbook-step-desc">Send Ctrl+C to stop current operation</span>
              </div>
              <div class="playbook-step" data-step="restart">
                <span class="playbook-step-icon">3</span>
                <span class="playbook-step-name">Restart</span>
                <span class="playbook-step-desc">Kill and respawn the agent</span>
              </div>
            </div>
            <div class="health-playbook-log" id="playbookLog">
              <div class="playbook-log-empty">No recovery actions taken</div>
            </div>
          </div>

          <!-- Bulk actions -->
          <div class="health-actions">
            <button class="btn btn-sm" id="healthRefreshBtn" title="Refresh health data">Refresh</button>
            <button class="btn btn-sm btn-nudge" id="healthNudgeAllBtn" title="Nudge all stuck agents">Nudge All</button>
            <button class="btn btn-sm btn-restart" id="healthRestartAllBtn" title="Restart all agents">Restart All</button>
            <span class="health-last-update" id="healthLastUpdate">Updated: -</span>
          </div>
        </div>
        <div class="tab-pane" id="tab-graph">
          <div class="tab-title">Knowledge Graph</div>
          <div class="tab-description">Explore relationships between files, agents, decisions, and errors</div>

          <!-- Graph search and controls -->
          <div class="graph-controls">
            <div class="graph-search-row">
              <input type="text" class="graph-search-input" id="graphSearchInput" placeholder="e.g., Show everything related to trigger delivery..." autocomplete="off">
              <button class="btn btn-sm btn-primary" id="graphSearchBtn" title="Search the knowledge graph">Search</button>
            </div>
            <div class="graph-filter-row">
              <span class="graph-filter-label">Filter:</span>
              <button class="graph-filter-btn active" data-type="all">All</button>
              <button class="graph-filter-btn" data-type="file">Files</button>
              <button class="graph-filter-btn" data-type="agent">Agents</button>
              <button class="graph-filter-btn" data-type="decision">Decisions</button>
              <button class="graph-filter-btn" data-type="error">Errors</button>
              <button class="graph-filter-btn" data-type="task">Tasks</button>
              <button class="graph-filter-btn" data-type="concept">Concepts</button>
            </div>
          </div>

          <!-- Graph stats overview -->
          <div class="graph-stats-overview" id="graphStatsOverview">
            <div class="graph-stat-card">
              <div class="graph-stat-value" id="graphNodeCount">0</div>
              <div class="graph-stat-label">Nodes</div>
            </div>
            <div class="graph-stat-card">
              <div class="graph-stat-value" id="graphEdgeCount">0</div>
              <div class="graph-stat-label">Edges</div>
            </div>
            <div class="graph-stat-card">
              <div class="graph-stat-value" id="graphFileCount">0</div>
              <div class="graph-stat-label">Files</div>
            </div>
            <div class="graph-stat-card">
              <div class="graph-stat-value" id="graphDecisionCount">0</div>
              <div class="graph-stat-label">Decisions</div>
            </div>
          </div>

          <!-- Graph visualization area -->
          <div class="graph-container" id="graphContainer">
            <div class="graph-canvas-wrapper">
              <canvas id="graphCanvas" width="600" height="300"></canvas>
              <div class="graph-empty" id="graphEmpty">
                <div class="graph-empty-icon">üîó</div>
                <div class="graph-empty-text">No graph data yet</div>
                <div class="graph-empty-hint">File accesses, decisions, and errors will appear here as agents work</div>
              </div>
            </div>
            <div class="graph-legend" id="graphLegend">
              <div class="graph-legend-item" data-type="file"><span class="legend-dot file"></span>File</div>
              <div class="graph-legend-item" data-type="agent"><span class="legend-dot agent"></span>Agent</div>
              <div class="graph-legend-item" data-type="decision"><span class="legend-dot decision"></span>Decision</div>
              <div class="graph-legend-item" data-type="error"><span class="legend-dot error"></span>Error</div>
              <div class="graph-legend-item" data-type="task"><span class="legend-dot task"></span>Task</div>
              <div class="graph-legend-item" data-type="concept"><span class="legend-dot concept"></span>Concept</div>
            </div>
          </div>

          <!-- Selected node details -->
          <div class="graph-details" id="graphDetails">
            <div class="graph-details-header">
              <span class="graph-details-title" id="graphDetailsTitle">Select a node</span>
              <span class="graph-details-type" id="graphDetailsType"></span>
            </div>
            <div class="graph-details-content" id="graphDetailsContent">
              <div class="graph-details-empty">Click a node to see details</div>
            </div>
            <div class="graph-related-list" id="graphRelatedList"></div>
          </div>

          <!-- Graph actions -->
          <div class="graph-actions">
            <button class="btn btn-sm" id="graphRefreshBtn" title="Refresh graph data">Refresh</button>
            <button class="btn btn-sm" id="graphSaveBtn" title="Save graph to disk">Save</button>
            <button class="btn btn-sm" id="graphResetViewBtn" title="Reset zoom and pan">Reset View</button>
            <span class="graph-last-update" id="graphLastUpdate">Updated: -</span>
          </div>
        </div>

        <div class="tab-pane" id="tab-workflow">
          <div class="tab-title">Workflow Builder</div>
          <div class="tab-description">Design multi-agent orchestration workflows with drag-and-drop</div>

          <div class="workflow-toolbar">
            <!-- Control nodes -->
            <div class="workflow-toolbar-group" title="Control Flow">
              <button class="btn btn-sm workflow-node-btn type-trigger" data-node-type="trigger" title="Entry point - starts workflow">Trigger</button>
              <button class="btn btn-sm workflow-node-btn type-decision" data-node-type="decision" title="Conditional branching">Decision</button>
              <button class="btn btn-sm workflow-node-btn type-loop" data-node-type="loop" title="Iterate over collection">Loop</button>
              <button class="btn btn-sm workflow-node-btn type-parallel" data-node-type="parallel" title="Parallel execution">Parallel</button>
              <button class="btn btn-sm workflow-node-btn type-merge" data-node-type="merge" title="Merge multiple inputs">Merge</button>
              <button class="btn btn-sm workflow-node-btn type-delay" data-node-type="delay" title="Wait/delay">Delay</button>
            </div>

            <!-- Processing nodes -->
            <div class="workflow-toolbar-group" title="Processing">
              <button class="btn btn-sm workflow-node-btn type-agent" data-node-type="agent" title="AI agent processing">Agent</button>
              <button class="btn btn-sm workflow-node-btn type-tool" data-node-type="tool" title="Tool/function call">Tool</button>
              <button class="btn btn-sm workflow-node-btn type-transform" data-node-type="transform" title="Data transformation">Transform</button>
            </div>

            <!-- I/O nodes -->
            <div class="workflow-toolbar-group" title="Input/Output">
              <button class="btn btn-sm workflow-node-btn type-input" data-node-type="input" title="Data input">Input</button>
              <button class="btn btn-sm workflow-node-btn type-output" data-node-type="output" title="Data output">Output</button>
            </div>

            <!-- Advanced -->
            <div class="workflow-toolbar-group" title="Advanced">
              <button class="btn btn-sm workflow-node-btn type-subworkflow" data-node-type="subworkflow" title="Nested workflow">Subflow</button>
            </div>
          </div>

          <div class="workflow-toolbar workflow-toolbar-secondary">
            <!-- Edit operations -->
            <div class="workflow-toolbar-group">
              <button class="btn btn-sm" id="workflowConnectBtn" title="Toggle connect mode (click nodes to link)">Connect</button>
              <button class="btn btn-sm" id="workflowDeleteNodeBtn" title="Delete selected (Del)">Delete</button>
              <button class="btn btn-sm" id="workflowDuplicateNodeBtn" title="Duplicate selected (Ctrl+D)">Duplicate</button>
            </div>

            <!-- Undo/Redo -->
            <div class="workflow-toolbar-group">
              <button class="btn btn-sm" id="workflowUndoBtn" title="Undo (Ctrl+Z)">Undo</button>
              <button class="btn btn-sm" id="workflowRedoBtn" title="Redo (Ctrl+Y)">Redo</button>
            </div>

            <!-- View controls -->
            <div class="workflow-toolbar-group">
              <button class="btn btn-sm" id="workflowZoomInBtn" title="Zoom in">+</button>
              <button class="btn btn-sm" id="workflowZoomOutBtn" title="Zoom out">-</button>
              <button class="btn btn-sm" id="workflowZoomResetBtn" title="Reset view">Reset</button>
              <button class="btn btn-sm" id="workflowAutoLayoutBtn" title="Auto-arrange nodes">Layout</button>
            </div>

            <!-- File operations -->
            <div class="workflow-toolbar-group">
              <button class="btn btn-sm" id="workflowTemplateBtn" title="Load from template">Template</button>
              <button class="btn btn-sm" id="workflowSaveBtn" title="Save workflow">Save</button>
              <button class="btn btn-sm" id="workflowLoadBtn" title="Load workflow">Load</button>
              <button class="btn btn-sm" id="workflowImportBtn" title="Import from file">Import</button>
              <button class="btn btn-sm" id="workflowExportBtn" title="Export to file">Export</button>
            </div>

            <!-- Workflow actions -->
            <div class="workflow-toolbar-group">
              <button class="btn btn-sm" id="workflowValidateBtn" title="Validate workflow">Validate</button>
              <button class="btn btn-sm btn-primary" id="workflowExecuteBtn" title="Generate execution plan">Plan</button>
              <button class="btn btn-sm" id="workflowClearBtn" title="Clear all nodes">Clear</button>
            </div>
          </div>

          <div class="workflow-body">
            <div class="workflow-canvas" id="workflowCanvas">
              <svg class="workflow-edges" id="workflowEdges" aria-hidden="true"></svg>
              <div class="workflow-nodes" id="workflowNodes"></div>
              <div class="workflow-empty" id="workflowEmpty">
                <div class="workflow-empty-icon">+</div>
                <div class="workflow-empty-text">Add nodes from the toolbar to create a workflow</div>
                <div class="workflow-empty-hint">Or load a template to get started</div>
              </div>
            </div>
            <div class="workflow-inspector" id="workflowInspector">
              <div class="workflow-inspector-title">Inspector</div>
              <div class="workflow-inspector-body" id="workflowInspectorBody">
                <div class="workflow-inspector-empty">Select a node to edit details</div>
              </div>
            </div>
          </div>

          <div class="workflow-footer">
            <span class="workflow-status" id="workflowStatus">Ready</span>
            <span class="workflow-stats" id="workflowStats">0 nodes / 0 links</span>
          </div>
        </div>
        <div class="tab-pane" id="tab-debug">
          <div class="tab-title">Debug Replay</div>
          <div class="tab-description">Step through agent actions for debugging</div>

          <!-- Session selector -->
          <div class="debug-session-selector">
            <select class="debug-agent-select" id="debugAgentSelect">
              <option value="">Select Agent...</option>
              <option value="Architect">Architect</option>
              <option value="Infra">Infra</option>
              <option value="Frontend">Frontend</option>
              <option value="Backend">Backend</option>
              <option value="Analyst">Analyst</option>
              <option value="Reviewer">Reviewer</option>
            </select>
            <button class="btn btn-sm btn-primary" id="debugLoadBtn" title="Load session for selected agent">Load</button>
            <button class="btn btn-sm" id="debugLoadAllBtn" title="Load last hour across all agents">Load All (1h)</button>
          </div>

          <!-- Replay controls -->
          <div class="debug-controls" id="debugControls">
            <div class="debug-controls-row">
              <button class="debug-btn" id="debugResetBtn" title="Reset to beginning">‚èÆ</button>
              <button class="debug-btn" id="debugBackBtn" title="Step backward">‚óÄ</button>
              <button class="debug-btn debug-btn-primary" id="debugPlayPauseBtn" title="Play/Pause">‚ñ∂</button>
              <button class="debug-btn" id="debugForwardBtn" title="Step forward">‚ñ∂</button>
              <button class="debug-btn" id="debugEndBtn" title="Jump to end">‚è≠</button>
            </div>
            <div class="debug-speed-row">
              <span class="debug-speed-label">Speed:</span>
              <button class="debug-speed-btn" data-speed="0.5">0.5x</button>
              <button class="debug-speed-btn active" data-speed="1">1x</button>
              <button class="debug-speed-btn" data-speed="2">2x</button>
              <button class="debug-speed-btn" data-speed="4">4x</button>
            </div>
          </div>

          <!-- Progress bar -->
          <div class="debug-progress" id="debugProgress">
            <div class="debug-progress-bar">
              <div class="debug-progress-fill" id="debugProgressFill"></div>
              <div class="debug-progress-marker" id="debugProgressMarker"></div>
            </div>
            <div class="debug-progress-info">
              <span class="debug-position" id="debugPosition">0 / 0</span>
              <span class="debug-timestamp" id="debugTimestamp">--:--:--</span>
            </div>
          </div>

          <!-- Filter bar -->
          <div class="debug-filters">
            <span class="debug-filter-label">Filter:</span>
            <button class="debug-filter-btn active" data-filter="all">All</button>
            <button class="debug-filter-btn" data-filter="communication">Comms</button>
            <button class="debug-filter-btn" data-filter="tools">Tools</button>
            <button class="debug-filter-btn" data-filter="decisions">Decisions</button>
            <button class="debug-filter-btn" data-filter="errors">Errors</button>
            <input type="text" class="debug-search" id="debugSearch" placeholder="Search..." autocomplete="off">
          </div>

          <!-- Action timeline -->
          <div class="debug-timeline" id="debugTimeline">
            <div class="debug-timeline-empty">Load a session to view actions</div>
          </div>

          <!-- Current action details -->
          <div class="debug-action-details" id="debugActionDetails">
            <div class="debug-action-header">
              <span class="debug-action-type" id="debugActionType">-</span>
              <span class="debug-action-time" id="debugActionTime">-</span>
            </div>
            <div class="debug-action-content" id="debugActionContent">
              <div class="debug-action-empty">Select an action to view details</div>
            </div>
            <div class="debug-action-metadata" id="debugActionMetadata"></div>
            <div class="debug-related-actions" id="debugRelatedActions"></div>
          </div>

          <!-- Stats and actions -->
          <div class="debug-footer">
            <div class="debug-stats" id="debugStats">
              <span class="debug-stat"><strong id="debugTotalActions">0</strong> actions</span>
              <span class="debug-stat"><strong id="debugErrorCount">0</strong> errors</span>
              <span class="debug-stat"><strong id="debugToolCount">0</strong> tools</span>
            </div>
            <div class="debug-actions-btns">
              <button class="btn btn-sm" id="debugExportBtn" title="Export session as JSON">Export</button>
              <button class="btn btn-sm" id="debugBreakpointsBtn" title="Manage breakpoints">Breakpoints</button>
            </div>
          </div>
        </div>

        <!-- REVIEW TAB (Task #18: AI-Powered Code Review) -->
        <div class="tab-pane" id="tab-review">
          <div class="tab-title">Code Review</div>
          <div class="tab-description">AI-powered review of your changes</div>

          <!-- Review mode selector -->
          <div class="review-mode-selector">
            <button class="review-mode-btn active" data-mode="all" title="Review all changes">All Changes</button>
            <button class="review-mode-btn" data-mode="staged" title="Review only staged changes">Staged</button>
            <button class="review-mode-btn" data-mode="unstaged" title="Review only unstaged changes">Unstaged</button>
          </div>

          <!-- Review actions -->
          <div class="review-actions">
            <button class="btn btn-primary" id="reviewRunBtn" title="Run AI code review">
              <span class="review-btn-icon">üîç</span>
              <span class="review-btn-text">Review Changes</span>
            </button>
            <button class="btn btn-sm" id="reviewHistoryBtn" title="View past reviews">History</button>
            <button class="btn btn-sm" id="reviewSettingsBtn" title="Review settings">Settings</button>
          </div>

          <!-- AI status indicator -->
          <div class="review-ai-status" id="reviewAIStatus">
            <span class="review-ai-indicator"></span>
            <span class="review-ai-label">AI Review</span>
            <span class="review-ai-status-text">Checking...</span>
          </div>

          <!-- Review summary -->
          <div class="review-summary" id="reviewSummary">
            <div class="review-summary-text">Click "Review Changes" to start</div>
            <div class="review-stats" id="reviewStats"></div>
          </div>

          <!-- Issue severity filters -->
          <div class="review-severity-filters" id="reviewSeverityFilters">
            <button class="review-sev-btn active" data-severity="all" title="Show all issues">All</button>
            <button class="review-sev-btn critical" data-severity="critical" title="Critical issues">
              <span class="review-sev-badge critical" id="reviewCriticalCount">0</span> Critical
            </button>
            <button class="review-sev-btn high" data-severity="high" title="High severity">
              <span class="review-sev-badge high" id="reviewHighCount">0</span> High
            </button>
            <button class="review-sev-btn medium" data-severity="medium" title="Medium severity">
              <span class="review-sev-badge medium" id="reviewMediumCount">0</span> Medium
            </button>
            <button class="review-sev-btn low" data-severity="low" title="Low/Info">
              <span class="review-sev-badge low" id="reviewLowCount">0</span> Low
            </button>
          </div>

          <!-- Issues list -->
          <div class="review-issues-container">
            <div class="review-issues-header">
              <span class="review-issues-title">Issues</span>
              <span class="review-issues-count" id="reviewIssueCount">0 issues</span>
            </div>
            <div class="review-issues-list" id="reviewIssuesList">
              <div class="review-empty" id="reviewEmpty">
                <div class="review-empty-icon">‚úì</div>
                <div class="review-empty-text">No issues found</div>
              </div>
            </div>
          </div>

          <!-- Issue details panel -->
          <div class="review-details" id="reviewDetails">
            <div class="review-details-header">
              <span class="review-details-title" id="reviewDetailsTitle">Issue Details</span>
              <button class="review-details-close" id="reviewDetailsClose">&times;</button>
            </div>
            <div class="review-details-content" id="reviewDetailsContent">
              <div class="review-detail-empty">Select an issue to view details</div>
            </div>
          </div>

          <!-- Loading overlay -->
          <div class="review-loading hidden" id="reviewLoading">
            <div class="review-loading-spinner"></div>
            <div class="review-loading-text">Analyzing code...</div>
          </div>
        </div>

        <!-- DOCS TAB (Task #23: Automated Documentation Generation) -->
        <div class="tab-pane" id="tab-docs">
          <div class="tab-title">Documentation</div>
          <div class="tab-description">Auto-generate docs from code comments and structure</div>

          <!-- Docs mode selector -->
          <div class="docs-mode-selector">
            <button class="docs-mode-btn active" data-mode="file" title="Document a single file">File</button>
            <button class="docs-mode-btn" data-mode="directory" title="Document a directory">Directory</button>
            <button class="docs-mode-btn" data-mode="project" title="Document entire project">Project</button>
          </div>

          <!-- File/Directory picker -->
          <div class="docs-target-row">
            <input type="text" class="docs-target-input" id="docsTargetInput" placeholder="Enter file or directory path..." autocomplete="off">
            <button class="btn btn-sm" id="docsBrowseBtn" title="Browse for file or directory">Browse</button>
          </div>

          <!-- Output format -->
          <div class="docs-format-row">
            <span class="docs-format-label">Format:</span>
            <select class="docs-format-select" id="docsFormatSelect">
              <option value="markdown" selected>Markdown</option>
              <option value="html">HTML</option>
              <option value="json">JSON</option>
            </select>
          </div>

          <!-- Generate actions -->
          <div class="docs-actions">
            <button class="btn btn-primary" id="docsGenerateBtn" title="Generate documentation">
              <span class="docs-btn-icon">üìÑ</span>
              <span class="docs-btn-text">Generate Docs</span>
            </button>
            <button class="btn btn-sm" id="docsPreviewBtn" title="Preview documentation">Preview</button>
            <button class="btn btn-sm" id="docsCoverageBtn" title="Check documentation coverage">Coverage</button>
            <button class="btn btn-sm" id="docsSettingsBtn" title="Documentation settings">Settings</button>
          </div>

          <!-- Coverage summary -->
          <div class="docs-coverage" id="docsCoverage">
            <div class="docs-coverage-header">
              <span class="docs-coverage-title">Coverage</span>
              <span class="docs-coverage-percent" id="docsCoveragePercent">--%</span>
            </div>
            <div class="docs-coverage-bar">
              <div class="docs-coverage-fill" id="docsCoverageFill" style="width: 0%"></div>
            </div>
            <div class="docs-coverage-stats" id="docsCoverageStats">
              <span class="docs-stat">Documented: <strong id="docsDocumentedCount">0</strong></span>
              <span class="docs-stat">Undocumented: <strong id="docsUndocumentedCount">0</strong></span>
              <span class="docs-stat">Total: <strong id="docsTotalCount">0</strong></span>
            </div>
          </div>

          <!-- Generated docs preview -->
          <div class="docs-preview-container" id="docsPreviewContainer">
            <div class="docs-preview-header">
              <span class="docs-preview-title">Documentation Preview</span>
              <div class="docs-preview-actions">
                <button class="btn btn-sm" id="docsCopyBtn" title="Copy to clipboard">Copy</button>
                <button class="btn btn-sm" id="docsExportBtn" title="Export to file">Export</button>
              </div>
            </div>
            <div class="docs-preview-content" id="docsPreviewContent">
              <div class="docs-preview-empty">Generate documentation to see preview</div>
            </div>
          </div>

          <!-- Undocumented items list -->
          <div class="docs-undocumented" id="docsUndocumented">
            <div class="docs-undocumented-header">
              <span class="docs-undocumented-title">Undocumented Items</span>
              <span class="docs-undocumented-count" id="docsUndocumentedItemCount">0 items</span>
            </div>
            <div class="docs-undocumented-list" id="docsUndocumentedList">
              <div class="docs-undocumented-empty">All exported items are documented!</div>
            </div>
          </div>

          <!-- Loading overlay -->
          <div class="docs-loading hidden" id="docsLoading">
            <div class="docs-loading-spinner"></div>
            <div class="docs-loading-text">Generating documentation...</div>
          </div>
        </div>

        <!-- COSTS TAB (Task #24: Cost Optimization Engine) -->
        <div class="tab-pane" id="tab-costs">
          <div class="tab-title">Cost Optimization</div>
          <div class="tab-description">Track API costs, predict budgets, optimize spending</div>

          <!-- Cost overview cards -->
          <div class="cost-overview">
            <div class="cost-card primary">
              <div class="cost-card-value" id="costTotalValue">$0.00</div>
              <div class="cost-card-label">Total</div>
            </div>
            <div class="cost-card">
              <div class="cost-card-value" id="costTodayValue">$0.00</div>
              <div class="cost-card-label">Today</div>
            </div>
            <div class="cost-card">
              <div class="cost-card-value" id="costWeekValue">$0.00</div>
              <div class="cost-card-label">This Week</div>
            </div>
            <div class="cost-card">
              <div class="cost-card-value" id="costMonthValue">$0.00</div>
              <div class="cost-card-label">This Month</div>
            </div>
          </div>

          <!-- Budget progress -->
          <div class="cost-budget-section" id="costBudgetSection">
            <div class="cost-budget-header">
              <span class="cost-budget-title">Daily Budget</span>
              <span class="cost-budget-value" id="costBudgetValue">Not set</span>
            </div>
            <div class="cost-budget-bar">
              <div class="cost-budget-fill" id="costBudgetFill" style="width: 0%"></div>
            </div>
            <div class="cost-budget-labels">
              <span id="costBudgetUsed">$0.00 used</span>
              <span id="costBudgetRemaining">--</span>
            </div>
          </div>

          <!-- Predictions -->
          <div class="cost-predictions" id="costPredictions">
            <div class="cost-predictions-header">
              <span class="cost-predictions-title">Predictions</span>
              <span class="cost-predictions-trend" id="costTrend">--</span>
            </div>
            <div class="cost-predictions-grid">
              <div class="cost-prediction-item">
                <span class="cost-prediction-label">Est. Daily</span>
                <span class="cost-prediction-value" id="costPredictDaily">--</span>
              </div>
              <div class="cost-prediction-item">
                <span class="cost-prediction-label">Est. Weekly</span>
                <span class="cost-prediction-value" id="costPredictWeekly">--</span>
              </div>
              <div class="cost-prediction-item">
                <span class="cost-prediction-label">Est. Monthly</span>
                <span class="cost-prediction-value" id="costPredictMonthly">--</span>
              </div>
              <div class="cost-prediction-item">
                <span class="cost-prediction-label">Confidence</span>
                <span class="cost-prediction-value" id="costPredictConfidence">--</span>
              </div>
            </div>
          </div>

          <!-- Agent breakdown -->
          <div class="cost-breakdown" id="costBreakdown">
            <div class="cost-breakdown-header">
              <span class="cost-breakdown-title">Cost by Agent</span>
              <button class="btn btn-sm" id="costViewByTaskBtn">By Task</button>
            </div>
            <div class="cost-breakdown-list" id="costBreakdownList">
              <div class="cost-breakdown-empty">No cost data yet</div>
            </div>
          </div>

          <!-- Optimizations -->
          <div class="cost-optimizations" id="costOptimizations">
            <div class="cost-optimizations-header">
              <span class="cost-optimizations-title">Optimization Suggestions</span>
              <span class="cost-optimizations-savings" id="costSavingsValue">$0.00 potential</span>
            </div>
            <div class="cost-optimizations-list" id="costOptimizationsList">
              <div class="cost-optimization-empty">Analyzing spending patterns...</div>
            </div>
          </div>

          <!-- Actions -->
          <div class="cost-actions">
            <button class="btn" id="costRefreshBtn" title="Refresh cost data">Refresh</button>
            <button class="btn" id="costSetBudgetBtn" title="Set budget limits">Set Budget</button>
            <button class="btn" id="costHistoryBtn" title="View cost history">History</button>
            <button class="btn" id="costAlertsBtn" title="View cost alerts">
              Alerts <span class="cost-alert-badge hidden" id="costAlertBadge">0</span>
            </button>
            <button class="btn btn-sm" id="costResetBtn" title="Reset all cost tracking">Reset</button>
          </div>

          <!-- Loading overlay -->
          <div class="cost-loading hidden" id="costLoading">
            <div class="cost-loading-spinner"></div>
            <div class="cost-loading-text">Loading cost data...</div>
          </div>
        </div>

        <!-- SECURITY TAB (Task #25: Security Hardening) -->
        <div class="tab-pane" id="tab-security">
          <div class="tab-title">Security</div>
          <div class="tab-description">Authentication, encryption, and access control</div>

          <!-- Security status -->
          <div class="security-status" id="securityStatus">
            <div class="security-status-indicator secure" id="securityIndicator">
              <span class="security-icon">üîí</span>
              <span class="security-label">Secure</span>
            </div>
            <div class="security-stats">
              <div class="security-stat">
                <span class="security-stat-value" id="secActiveSessionsCount">0</span>
                <span class="security-stat-label">Active Sessions</span>
              </div>
              <div class="security-stat">
                <span class="security-stat-value" id="secCredentialsCount">0</span>
                <span class="security-stat-label">Stored Credentials</span>
              </div>
              <div class="security-stat">
                <span class="security-stat-value" id="secAuditCount">0</span>
                <span class="security-stat-label">Audit Events</span>
              </div>
            </div>
          </div>

          <!-- Credentials section -->
          <div class="security-section" id="secCredentialsSection">
            <div class="security-section-header">
              <span class="security-section-title">Stored Credentials</span>
              <button class="btn btn-sm" id="secAddCredentialBtn">+ Add</button>
            </div>
            <div class="security-credentials-list" id="secCredentialsList">
              <div class="security-empty">No credentials stored</div>
            </div>
          </div>

          <!-- Sessions section -->
          <div class="security-section" id="secSessionsSection">
            <div class="security-section-header">
              <span class="security-section-title">Active Sessions</span>
              <button class="btn btn-sm btn-danger" id="secRevokeAllBtn">Revoke All</button>
            </div>
            <div class="security-sessions-list" id="secSessionsList">
              <div class="security-empty">No active sessions</div>
            </div>
          </div>

          <!-- Roles section -->
          <div class="security-section" id="secRolesSection">
            <div class="security-section-header">
              <span class="security-section-title">Roles & Permissions</span>
            </div>
            <div class="security-roles-list" id="secRolesList">
              <div class="security-role-item">
                <span class="security-role-name">admin</span>
                <span class="security-role-desc">Full system access</span>
              </div>
              <div class="security-role-item">
                <span class="security-role-name">operator</span>
                <span class="security-role-desc">Execute agents, manage files</span>
              </div>
              <div class="security-role-item">
                <span class="security-role-name">viewer</span>
                <span class="security-role-desc">Read-only access</span>
              </div>
            </div>
          </div>

          <!-- Audit log section -->
          <div class="security-section" id="secAuditSection">
            <div class="security-section-header">
              <span class="security-section-title">Recent Security Events</span>
              <button class="btn btn-sm" id="secViewAuditBtn">View All</button>
            </div>
            <div class="security-audit-list" id="secAuditList">
              <div class="security-empty">No recent events</div>
            </div>
          </div>

          <!-- Actions -->
          <div class="security-actions">
            <button class="btn" id="secRefreshBtn" title="Refresh security data">Refresh</button>
            <button class="btn" id="secEncryptBtn" title="Encrypt/decrypt data">Encrypt</button>
            <button class="btn" id="secCreateSessionBtn" title="Create a new session">New Session</button>
            <button class="btn btn-sm" id="secCleanupBtn" title="Clean expired sessions">Cleanup</button>
          </div>

          <!-- Loading overlay -->
          <div class="security-loading hidden" id="securityLoading">
            <div class="security-loading-spinner"></div>
            <div class="security-loading-text">Loading security data...</div>
          </div>
        </div>

        <!-- DASHBOARD TAB (Task #30: Multi-Project Dashboard) -->
        <div class="tab-pane" id="tab-dashboard">
          <div class="tab-title">Multi-Project Dashboard</div>
          <div class="tab-description">Manage projects, track metrics, and monitor health</div>

          <!-- Dashboard summary -->
          <div class="dashboard-summary" id="dashboardSummary">
            <div class="dashboard-stat">
              <span class="dashboard-stat-value" id="dashTotalProjects">0</span>
              <span class="dashboard-stat-label">Projects</span>
            </div>
            <div class="dashboard-stat">
              <span class="dashboard-stat-value" id="dashActiveProjects">0</span>
              <span class="dashboard-stat-label">Active</span>
            </div>
            <div class="dashboard-stat">
              <span class="dashboard-stat-value" id="dashAvgHealth">--</span>
              <span class="dashboard-stat-label">Avg Health</span>
            </div>
          </div>

          <!-- Active project indicator -->
          <div class="dashboard-active-project" id="dashboardActiveProject">
            <span class="dashboard-active-label">Active:</span>
            <span class="dashboard-active-name" id="dashActiveProjectName">None</span>
            <button class="btn btn-xs" id="dashSwitchProjectBtn" title="Switch project">Switch</button>
          </div>

          <!-- Project list section -->
          <div class="dashboard-section">
            <div class="dashboard-section-header">
              <span class="dashboard-section-title">Projects</span>
              <button class="btn btn-xs btn-primary" id="dashAddProjectBtn" title="Register new project">+ Add</button>
            </div>
            <div class="dashboard-project-list" id="dashboardProjectList">
              <div class="dashboard-empty">No projects registered</div>
            </div>
          </div>

          <!-- Health scores section -->
          <div class="dashboard-section">
            <div class="dashboard-section-header">
              <span class="dashboard-section-title">Health Scores</span>
              <button class="btn btn-xs" id="dashRefreshHealthBtn" title="Refresh health scores">Refresh</button>
            </div>
            <div class="dashboard-health-list" id="dashboardHealthList">
              <div class="dashboard-empty">No health data</div>
            </div>
          </div>

          <!-- Recent activity section -->
          <div class="dashboard-section">
            <div class="dashboard-section-header">
              <span class="dashboard-section-title">Recent Activity</span>
            </div>
            <div class="dashboard-activity-list" id="dashboardActivityList">
              <div class="dashboard-empty">No recent activity</div>
            </div>
          </div>

          <!-- Dashboard actions -->
          <div class="dashboard-actions">
            <button class="btn btn-sm" id="dashExportBtn" title="Export project data">Export</button>
            <button class="btn btn-sm" id="dashImportBtn" title="Import project data">Import</button>
            <button class="btn btn-sm" id="dashCompareBtn" title="Compare selected projects">Compare</button>
          </div>

          <!-- Loading overlay -->
          <div class="dashboard-loading hidden" id="dashboardLoading">
            <div class="dashboard-loading-spinner"></div>
            <div class="dashboard-loading-text">Loading dashboard data...</div>
          </div>
        </div>

        <div class="tab-pane" id="tab-projects">
          <div class="tab-title">Recent Projects</div>
          <div class="tab-description">Quick-switch between projects</div>
          <div class="projects-list" id="projectsList">
            <div class="projects-empty">No recent projects</div>
          </div>
          <div class="projects-actions">
            <button class="btn btn-folder" id="addProjectBtn" title="Browse for a new project folder">Add Project</button>
            <button class="btn" id="refreshProjectsBtn" title="Reload recent projects list">Refresh</button>
          </div>
        </div>
        <div class="tab-pane" id="tab-git">
          <div class="tab-title">Git Integration</div>
          <div class="tab-description">Repository status, diffs, and quick actions</div>
          <div class="git-status-message" id="gitStatusMessage">Loading git status...</div>
          <div class="git-summary" id="gitSummary">
            <div class="git-summary-card">
              <div class="git-summary-label">Branch</div>
              <div class="git-summary-value" id="gitBranchValue">--</div>
              <div class="git-summary-sub" id="gitUpstreamValue">--</div>
            </div>
            <div class="git-summary-card">
              <div class="git-summary-label">Ahead / Behind</div>
              <div class="git-summary-value" id="gitAheadBehindValue">0 / 0</div>
              <div class="git-summary-sub" id="gitRepoRootValue">--</div>
            </div>
            <div class="git-summary-card">
              <div class="git-summary-label">Last Commit</div>
              <div class="git-summary-value" id="gitLastCommitValue">--</div>
              <div class="git-summary-sub" id="gitLastCommitMeta">--</div>
            </div>
            <div class="git-summary-card status">
              <div class="git-summary-label">Working Tree</div>
              <div class="git-summary-value" id="gitCleanValue">Clean</div>
              <div class="git-summary-sub" id="gitChangeCount">0 changes</div>
            </div>
          </div>
          <div class="git-sections">
            <div class="git-section">
              <div class="git-section-title">Staged</div>
              <div class="git-file-list" id="gitStagedList">
                <div class="git-empty">No staged files</div>
              </div>
            </div>
            <div class="git-section">
              <div class="git-section-title">Unstaged</div>
              <div class="git-file-list" id="gitUnstagedList">
                <div class="git-empty">No unstaged files</div>
              </div>
            </div>
            <div class="git-section">
              <div class="git-section-title">Untracked</div>
              <div class="git-file-list" id="gitUntrackedList">
                <div class="git-empty">No untracked files</div>
              </div>
            </div>
            <div class="git-section">
              <div class="git-section-title">Conflicts</div>
              <div class="git-file-list" id="gitConflictedList">
                <div class="git-empty">No conflicts</div>
              </div>
            </div>
          </div>
          <div class="git-diff">
            <div class="git-diff-header">
              <div class="git-section-title">Diff Preview</div>
              <div class="git-diff-controls">
                <select id="gitDiffMode" class="git-diff-select" title="Select diff view">
                  <option value="unstaged" selected>Unstaged</option>
                  <option value="staged">Staged</option>
                </select>
                <button class="btn btn-secondary" id="gitDiffRefreshBtn" title="Refresh diff output">Show Diff</button>
              </div>
            </div>
            <pre class="git-diff-output" id="gitDiffOutput"></pre>
          </div>
          <div class="git-commit">
            <input type="text" class="git-commit-input" id="gitCommitMessage" placeholder="Commit message..." autocomplete="off">
            <button class="btn" id="gitCommitBtn" title="Create commit with staged changes">Commit</button>
          </div>
          <div class="git-actions">
            <button class="btn" id="gitRefreshBtn" title="Reload git status">Refresh</button>
            <button class="btn btn-secondary" id="gitStageAllBtn" title="Stage all changes">Stage All</button>
            <button class="btn btn-secondary" id="gitUnstageAllBtn" title="Unstage all changes">Unstage All</button>
            <button class="btn btn-secondary" id="gitCopySummaryBtn" title="Copy git summary to clipboard">Copy Summary</button>
          </div>
        </div>
        <div class="tab-pane" id="tab-performance">
          <div class="tab-title">Agent Performance</div>
          <div class="tab-description">Track agent completions and response times</div>
          <div class="perf-grid" id="perfGrid">
            <div class="perf-card" data-pane="1">
              <div class="perf-card-header">Architect</div>
              <div class="perf-stat"><span class="perf-value" id="perf-completions-1">0</span><span class="perf-label">Completions</span></div>
              <div class="perf-stat"><span class="perf-value" id="perf-avgtime-1">--</span><span class="perf-label">Avg Time</span></div>
              <div class="perf-stat"><span class="perf-value" id="perf-success-1">--</span><span class="perf-label">Success</span></div>
            </div>
            <div class="perf-card" data-pane="2">
              <div class="perf-card-header">Infra</div>
              <div class="perf-stat"><span class="perf-value" id="perf-completions-2">0</span><span class="perf-label">Completions</span></div>
              <div class="perf-stat"><span class="perf-value" id="perf-avgtime-2">--</span><span class="perf-label">Avg Time</span></div>
              <div class="perf-stat"><span class="perf-value" id="perf-success-2">--</span><span class="perf-label">Success</span></div>
            </div>
            <div class="perf-card" data-pane="3">
              <div class="perf-card-header">Frontend</div>
              <div class="perf-stat"><span class="perf-value" id="perf-completions-3">0</span><span class="perf-label">Completions</span></div>
              <div class="perf-stat"><span class="perf-value" id="perf-avgtime-3">--</span><span class="perf-label">Avg Time</span></div>
              <div class="perf-stat"><span class="perf-value" id="perf-success-3">--</span><span class="perf-label">Success</span></div>
            </div>
            <div class="perf-card" data-pane="4">
              <div class="perf-card-header">Backend</div>
              <div class="perf-stat"><span class="perf-value" id="perf-completions-4">0</span><span class="perf-label">Completions</span></div>
              <div class="perf-stat"><span class="perf-value" id="perf-avgtime-4">--</span><span class="perf-label">Avg Time</span></div>
              <div class="perf-stat"><span class="perf-value" id="perf-success-4">--</span><span class="perf-label">Success</span></div>
            </div>
            <div class="perf-card" data-pane="5">
              <div class="perf-card-header">Analyst</div>
              <div class="perf-stat"><span class="perf-value" id="perf-completions-5">0</span><span class="perf-label">Completions</span></div>
              <div class="perf-stat"><span class="perf-value" id="perf-avgtime-5">--</span><span class="perf-label">Avg Time</span></div>
              <div class="perf-stat"><span class="perf-value" id="perf-success-5">--</span><span class="perf-label">Success</span></div>
            </div>
            <div class="perf-card" data-pane="6">
              <div class="perf-card-header">Reviewer</div>
              <div class="perf-stat"><span class="perf-value" id="perf-completions-6">0</span><span class="perf-label">Completions</span></div>
              <div class="perf-stat"><span class="perf-value" id="perf-avgtime-6">--</span><span class="perf-label">Avg Time</span></div>
              <div class="perf-stat"><span class="perf-value" id="perf-success-6">--</span><span class="perf-label">Success</span></div>
            </div>
          </div>
            <div class="perf-actions">
              <button class="btn" id="refreshPerfBtn" title="Reload performance statistics">Refresh</button>
              <button class="btn btn-danger" id="resetPerfBtn" title="Clear all performance data">Reset Stats</button>
            </div>
            <div class="perf-profile">
              <div class="perf-profile-header">
                <label class="perf-toggle">
                  <input type="checkbox" id="perfProfileEnabled" />
                  <span>Profiling Enabled</span>
                </label>
                <div class="perf-threshold">
                  <span>Slow Threshold</span>
                  <input type="number" id="perfSlowThreshold" min="10" max="2000" step="10" />
                  <span>ms</span>
                </div>
                <div class="perf-profile-actions">
                  <button class="btn btn-sm" id="perfProfileRefreshBtn">Refresh Profile</button>
                  <button class="btn btn-sm btn-danger" id="perfProfileResetBtn">Reset Profile</button>
                </div>
              </div>
              <div class="perf-profile-grid">
                <div class="perf-panel">
                  <div class="perf-panel-title">Handler Flame Graph (Avg Time)</div>
                  <div class="perf-flame" id="perfFlameGraph">
                    <div class="perf-empty">No profiling data yet</div>
                  </div>
                </div>
                <div class="perf-panel">
                  <div class="perf-panel-title">Slow Calls</div>
                  <div class="perf-list" id="perfSlowCalls"></div>
                </div>
              </div>
              <div class="perf-panel">
                <div class="perf-panel-title">Optimization Suggestions</div>
                <div class="perf-suggestions" id="perfSuggestions"></div>
              </div>
            </div>
          </div>
        <div class="tab-pane" id="tab-templates">
          <div class="tab-title">Agent Templates</div>
          <div class="tab-description">Save and load agent configurations</div>
          <div class="template-current">
            <div class="template-section-title">Current Configuration</div>
            <div class="template-save-form">
              <input type="text" class="template-input" id="templateNameInput" placeholder="Template name..." title="Enter a name for this configuration" autocomplete="off">
              <button class="btn btn-folder" id="saveTemplateBtn" title="Save current settings as a template">Save</button>
            </div>
          </div>
          <div class="template-list" id="templateList">
            <div class="template-empty">No saved templates</div>
          </div>
          <div class="template-actions">
            <button class="btn" id="refreshTemplatesBtn" title="Reload template list">Refresh</button>
          </div>
        </div>

        <!-- SCAFFOLD TAB (Task #12: Project Templates and Scaffolding) -->
        <div class="tab-pane" id="tab-scaffold">
          <div class="tab-title">Project Scaffolding</div>
          <div class="tab-description">Create new projects from pre-built templates</div>

          <!-- Category filter -->
          <div class="scaffold-categories" id="scaffoldCategories">
            <button class="scaffold-category active" data-category="all">All</button>
            <button class="scaffold-category" data-category="nodejs">Node.js</button>
            <button class="scaffold-category" data-category="python">Python</button>
            <button class="scaffold-category" data-category="frontend">Frontend</button>
            <button class="scaffold-category" data-category="desktop">Desktop</button>
            <button class="scaffold-category" data-category="hivemind">Hivemind</button>
            <button class="scaffold-category" data-category="custom">Custom</button>
          </div>

          <!-- Template list -->
          <div class="scaffold-template-list" id="scaffoldTemplateList">
            <div class="scaffold-empty">Loading templates...</div>
          </div>

          <!-- Selected template preview -->
          <div class="scaffold-preview hidden" id="scaffoldPreview">
            <div class="scaffold-preview-header">
              <span class="scaffold-preview-name" id="scaffoldPreviewName">Template Name</span>
              <button class="btn btn-xs" id="scaffoldPreviewClose" title="Close preview">X</button>
            </div>
            <div class="scaffold-preview-desc" id="scaffoldPreviewDesc">Description</div>
            <div class="scaffold-preview-structure">
              <div class="scaffold-preview-label">Structure:</div>
              <div class="scaffold-preview-dirs" id="scaffoldPreviewDirs"></div>
              <div class="scaffold-preview-files" id="scaffoldPreviewFiles"></div>
            </div>
          </div>

          <!-- Create project form -->
          <div class="scaffold-create-form" id="scaffoldCreateForm">
            <div class="scaffold-form-group">
              <label>Project Name</label>
              <input type="text" class="scaffold-input" id="scaffoldProjectName" placeholder="my-project" autocomplete="off">
            </div>
            <div class="scaffold-form-group">
              <label>Description</label>
              <input type="text" class="scaffold-input" id="scaffoldProjectDesc" placeholder="A brief description" autocomplete="off">
            </div>
            <div class="scaffold-form-group">
              <label>Location</label>
              <div class="scaffold-location-row">
                <input type="text" class="scaffold-input scaffold-location" id="scaffoldLocation" placeholder="Select folder..." readonly>
                <button class="btn btn-sm" id="scaffoldBrowseBtn" title="Browse for folder">Browse</button>
              </div>
            </div>
          </div>

          <!-- Actions -->
          <div class="scaffold-actions">
            <button class="btn btn-primary" id="scaffoldCreateBtn" title="Create project from selected template" disabled>Create Project</button>
            <button class="btn" id="scaffoldImportBtn" title="Import custom template">Import</button>
          </div>

          <!-- Loading overlay -->
          <div class="scaffold-loading hidden" id="scaffoldLoading">
            <div class="scaffold-loading-spinner"></div>
            <div class="scaffold-loading-text">Creating project...</div>
          </div>
        </div>

        <!-- DEPLOY TAB (Task #15: Automated Deployment Pipeline) -->
        <div class="tab-pane" id="tab-deploy">
          <div class="tab-title">Deployment Pipeline</div>
          <div class="tab-description">Build automation and CI/CD management</div>

          <!-- Git and environment status -->
          <div class="deploy-status-bar">
            <div class="deploy-git-info" id="deployGitInfo">
              <span class="deploy-branch" id="deployBranch">main</span>
              <span class="deploy-commit" id="deployCommit">-</span>
              <span class="deploy-dirty hidden" id="deployDirty" title="Uncommitted changes">*</span>
            </div>
            <div class="deploy-env-select">
              <label>Environment:</label>
              <select id="deployEnvSelect">
                <option value="development">Development</option>
                <option value="staging">Staging</option>
                <option value="production">Production</option>
              </select>
            </div>
          </div>

          <!-- Readiness checks -->
          <div class="deploy-readiness" id="deployReadiness">
            <div class="deploy-readiness-title">Deployment Readiness</div>
            <div class="deploy-checks" id="deployChecks">
              <div class="deploy-check-loading">Checking...</div>
            </div>
          </div>

          <!-- Pipeline stages -->
          <div class="deploy-pipeline" id="deployPipeline">
            <div class="deploy-pipeline-title">Pipeline Stages</div>
            <div class="deploy-stages" id="deployStages">
              <div class="deploy-stage" data-stage="install">
                <div class="deploy-stage-icon">1</div>
                <div class="deploy-stage-name">Install</div>
                <div class="deploy-stage-status">pending</div>
              </div>
              <div class="deploy-stage" data-stage="lint">
                <div class="deploy-stage-icon">2</div>
                <div class="deploy-stage-name">Lint</div>
                <div class="deploy-stage-status">pending</div>
              </div>
              <div class="deploy-stage" data-stage="test">
                <div class="deploy-stage-icon">3</div>
                <div class="deploy-stage-name">Test</div>
                <div class="deploy-stage-status">pending</div>
              </div>
              <div class="deploy-stage" data-stage="build">
                <div class="deploy-stage-icon">4</div>
                <div class="deploy-stage-name">Build</div>
                <div class="deploy-stage-status">pending</div>
              </div>
              <div class="deploy-stage" data-stage="package">
                <div class="deploy-stage-icon">5</div>
                <div class="deploy-stage-name">Package</div>
                <div class="deploy-stage-status">pending</div>
              </div>
              <div class="deploy-stage" data-stage="deploy">
                <div class="deploy-stage-icon">6</div>
                <div class="deploy-stage-name">Deploy</div>
                <div class="deploy-stage-status">pending</div>
              </div>
            </div>
          </div>

          <!-- Build output -->
          <div class="deploy-output-section">
            <div class="deploy-output-header">
              <span class="deploy-output-title">Build Output</span>
              <button class="btn btn-xs" id="deployClearOutputBtn" title="Clear output">Clear</button>
            </div>
            <div class="deploy-output" id="deployOutput">
              <div class="deploy-output-empty">No build output yet</div>
            </div>
          </div>

          <!-- Actions -->
          <div class="deploy-actions">
            <button class="btn btn-primary" id="deployStartBtn" title="Start build pipeline">Start Build</button>
            <button class="btn" id="deployCancelBtn" title="Cancel current build" disabled>Cancel</button>
            <button class="btn" id="deployQuickBtn" title="Quick development build">Quick Build</button>
            <button class="btn" id="deployGitHubBtn" title="Deploy to GitHub Release" disabled>Deploy to GitHub</button>
          </div>

          <!-- Build history -->
          <div class="deploy-history-section">
            <div class="deploy-history-title">Recent Builds</div>
            <div class="deploy-history" id="deployHistory">
              <div class="deploy-history-empty">No builds yet</div>
            </div>
          </div>
        </div>

        <!-- COLLAB TAB (Task #11: Real-time Collaboration) -->
        <div class="tab-pane" id="tab-collab">
          <div class="tab-title">Real-time Collaboration</div>
          <div class="tab-description">Share sessions and work together in real-time</div>

          <!-- Connection status -->
          <div class="collab-status-bar" id="collabStatusBar">
            <span class="collab-status-indicator disconnected" id="collabStatusIndicator"></span>
            <span class="collab-status-text" id="collabStatusText">Not connected</span>
            <span class="collab-user-count hidden" id="collabUserCount">0 users</span>
          </div>

          <!-- Session controls (when not in session) -->
          <div class="collab-session-controls" id="collabSessionControls">
            <div class="collab-section">
              <div class="collab-section-title">Start a Session</div>
              <div class="collab-form">
                <div class="collab-field">
                  <label>Session Name:</label>
                  <input type="text" id="collabSessionName" placeholder="My Hivemind Session" />
                </div>
                <div class="collab-field">
                  <label>Port:</label>
                  <input type="number" id="collabPort" value="9876" min="1024" max="65535" />
                </div>
                <div class="collab-field-row">
                  <label><input type="checkbox" id="collabAllowEdit" checked /> Allow editing</label>
                  <label><input type="checkbox" id="collabAllowChat" checked /> Allow chat</label>
                  <label><input type="checkbox" id="collabSyncTerminals" checked /> Sync terminals</label>
                </div>
                <button class="btn btn-primary" id="collabCreateBtn">Create Session</button>
              </div>
            </div>

            <div class="collab-divider">‚Äî or ‚Äî</div>

            <div class="collab-section">
              <div class="collab-section-title">Join a Session</div>
              <div class="collab-form">
                <div class="collab-field">
                  <label>Host:</label>
                  <input type="text" id="collabJoinHost" placeholder="localhost" value="localhost" />
                </div>
                <div class="collab-field">
                  <label>Port:</label>
                  <input type="number" id="collabJoinPort" placeholder="9876" />
                </div>
                <div class="collab-field">
                  <label>Invite Code (optional):</label>
                  <input type="text" id="collabJoinCode" placeholder="ABCD1234" />
                </div>
                <button class="btn btn-primary" id="collabJoinBtn">Join Session</button>
              </div>
            </div>
          </div>

          <!-- Active session view (when connected) -->
          <div class="collab-active-session hidden" id="collabActiveSession">
            <!-- Session info -->
            <div class="collab-session-info" id="collabSessionInfo">
              <div class="collab-session-name" id="collabCurrentName">-</div>
              <div class="collab-session-role" id="collabCurrentRole">-</div>
            </div>

            <!-- Invite section -->
            <div class="collab-invite-section" id="collabInviteSection">
              <div class="collab-section-title">Invite Others</div>
              <div class="collab-invite-link">
                <input type="text" id="collabInviteLink" readonly />
                <button class="btn btn-xs" id="collabCopyLinkBtn" title="Copy invite link">Copy</button>
              </div>
              <div class="collab-invite-code">
                Code: <span id="collabInviteCode">-</span>
                <button class="btn btn-xs" id="collabCopyCodeBtn" title="Copy code">Copy</button>
              </div>
            </div>

            <!-- Users list -->
            <div class="collab-users-section">
              <div class="collab-section-title">Connected Users</div>
              <div class="collab-users-list" id="collabUsersList">
                <div class="collab-users-empty">No other users</div>
              </div>
            </div>

            <!-- Chat -->
            <div class="collab-chat-section">
              <div class="collab-section-title">
                Chat
                <span class="collab-chat-badge hidden" id="collabChatBadge">0</span>
              </div>
              <div class="collab-chat-messages" id="collabChatMessages">
                <div class="collab-chat-empty">No messages yet</div>
              </div>
              <div class="collab-chat-input">
                <input type="text" id="collabChatInput" placeholder="Type a message..." />
                <button class="btn btn-xs" id="collabSendBtn">Send</button>
              </div>
            </div>

            <!-- Session settings (host only) -->
            <div class="collab-settings-section hidden" id="collabSettingsSection">
              <div class="collab-section-title">Session Settings</div>
              <div class="collab-settings">
                <label><input type="checkbox" id="collabSettingEdit" /> Allow editing</label>
                <label><input type="checkbox" id="collabSettingChat" /> Allow chat</label>
                <label><input type="checkbox" id="collabSettingSync" /> Sync terminals</label>
                <label><input type="checkbox" id="collabSettingSyncSettings" /> Sync settings</label>
                <div class="collab-field">
                  <label>Max users:</label>
                  <input type="number" id="collabSettingMaxUsers" min="2" max="20" value="10" />
                </div>
                <button class="btn btn-xs" id="collabSaveSettingsBtn">Save Settings</button>
              </div>
            </div>

            <!-- Leave button -->
            <div class="collab-actions">
              <button class="btn btn-danger" id="collabLeaveBtn">Leave Session</button>
            </div>
          </div>

          <!-- Profile settings -->
          <div class="collab-profile-section">
            <div class="collab-section-title">Your Profile</div>
            <div class="collab-profile">
              <div class="collab-field">
                <label>Display Name:</label>
                <input type="text" id="collabUserName" placeholder="Anonymous" />
              </div>
              <div class="collab-field">
                <label>Color:</label>
                <input type="color" id="collabUserColor" value="#4ECDC4" />
              </div>
              <button class="btn btn-xs" id="collabUpdateProfileBtn">Update Profile</button>
            </div>
          </div>
        </div>

        <div class="tab-pane" id="tab-mobile">
          <div class="tab-title">Mobile Companion</div>
          <div class="tab-description">Connect mobile app for remote monitoring</div>

          <!-- Server Status -->
          <div class="mobile-status-bar" id="mobileStatusBar">
            <span class="mobile-status-indicator stopped" id="mobileStatusIndicator"></span>
            <span class="mobile-status-text" id="mobileStatusText">Server stopped</span>
            <span class="mobile-client-count hidden" id="mobileClientCount">0 clients</span>
          </div>

          <!-- Server Controls -->
          <div class="mobile-server-controls" id="mobileServerControls">
            <div class="mobile-section">
              <div class="mobile-section-title">API Server</div>
              <div class="mobile-form">
                <div class="mobile-field">
                  <label>Port:</label>
                  <input type="number" id="mobilePort" value="8080" min="1024" max="65535" />
                </div>
                <div class="mobile-field-row">
                  <button class="btn btn-primary" id="mobileStartBtn">Start Server</button>
                  <button class="btn" id="mobileStopBtn" disabled>Stop Server</button>
                </div>
              </div>
            </div>

            <!-- QR Code -->
            <div class="mobile-section" id="mobileQrSection">
              <div class="mobile-section-title">Quick Connect</div>
              <div class="mobile-qr-container">
                <div class="mobile-qr-placeholder" id="mobileQrPlaceholder">
                  <span class="mobile-qr-icon">üì±</span>
                  <span class="mobile-qr-text">Start server to generate QR code</span>
                </div>
                <div class="mobile-qr-code hidden" id="mobileQrCode">
                  <canvas id="mobileQrCanvas" width="200" height="200"></canvas>
                </div>
                <div class="mobile-connection-info hidden" id="mobileConnectionInfo">
                  <div class="mobile-info-row">
                    <span class="mobile-info-label">Host:</span>
                    <span class="mobile-info-value" id="mobileHost">-</span>
                  </div>
                  <div class="mobile-info-row">
                    <span class="mobile-info-label">Port:</span>
                    <span class="mobile-info-value" id="mobilePortDisplay">-</span>
                  </div>
                  <div class="mobile-info-row">
                    <span class="mobile-info-label">API:</span>
                    <span class="mobile-info-value" id="mobileApiEndpoint">-</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Sessions -->
          <div class="mobile-section">
            <div class="mobile-section-title">Active Sessions</div>
            <div class="mobile-sessions-list" id="mobileSessionsList">
              <div class="mobile-sessions-empty">No active sessions</div>
            </div>
            <div class="mobile-session-actions">
              <button class="btn btn-xs" id="mobileCreateSessionBtn" disabled>Create Session</button>
              <button class="btn btn-xs" id="mobileRefreshSessionsBtn" disabled>Refresh</button>
            </div>
          </div>

          <!-- Push Subscriptions -->
          <div class="mobile-section">
            <div class="mobile-section-title">Push Subscriptions</div>
            <div class="mobile-push-list" id="mobilePushList">
              <div class="mobile-push-empty">No push subscriptions</div>
            </div>
          </div>

          <!-- Notification Settings -->
          <div class="mobile-section">
            <div class="mobile-section-title">Notification Settings</div>
            <div class="mobile-notification-settings">
              <label class="mobile-checkbox">
                <input type="checkbox" id="mobileNotifyAgentStatus" checked />
                Agent status changes
              </label>
              <label class="mobile-checkbox">
                <input type="checkbox" id="mobileNotifyAgentError" checked />
                Agent errors
              </label>
              <label class="mobile-checkbox">
                <input type="checkbox" id="mobileNotifyBuildStatus" checked />
                Build status
              </label>
              <label class="mobile-checkbox">
                <input type="checkbox" id="mobileNotifyChatMessage" />
                Chat messages
              </label>
              <label class="mobile-checkbox">
                <input type="checkbox" id="mobileNotifyTaskComplete" checked />
                Task completions
              </label>
            </div>
          </div>

          <!-- Test Notification -->
          <div class="mobile-section">
            <div class="mobile-section-title">Test</div>
            <div class="mobile-test-actions">
              <button class="btn btn-xs" id="mobileTestNotifyBtn" disabled>Send Test Notification</button>
            </div>
          </div>
        </div>

        <div class="tab-pane" id="tab-progress">
          <div class="tab-title">Build Progress</div>
          <div class="tab-description">Track task completion and checkpoints</div>

          <div class="progress-section">
            <div class="progress-label">Current State</div>
            <div class="progress-state-badge" id="progressState">IDLE</div>
          </div>

          <div class="progress-section">
            <div class="progress-label">Checkpoints</div>
            <div class="progress-checkpoints">
              <div class="checkpoint-bar">
                <div class="checkpoint-fill" id="checkpointFill" style="width: 0%"></div>
              </div>
              <span class="checkpoint-text" id="checkpointText">0 / 0</span>
            </div>
          </div>

          <div class="progress-section">
            <div class="progress-label">Active Agents</div>
            <div class="active-agents-list" id="activeAgentsList">
              <span class="no-agents">No agents active</span>
            </div>
          </div>

          <div class="progress-section">
            <div class="progress-label">Friction Count</div>
            <div class="friction-count-display" id="frictionCountDisplay">0</div>
          </div>

          <div class="progress-section usage-stats-section">
            <div class="progress-label">Usage Stats (Cost Tracking)</div>
            <div class="usage-stats-grid" id="usageStatsGrid">
              <div class="usage-stat">
                <span class="usage-stat-value" id="usageTotalSpawns">0</span>
                <span class="usage-stat-label">Total Spawns</span>
              </div>
              <div class="usage-stat">
                <span class="usage-stat-value" id="usageSessionsToday">0</span>
                <span class="usage-stat-label">Sessions Today</span>
              </div>
              <div class="usage-stat">
                <span class="usage-stat-value" id="usageTotalTime">0s</span>
                <span class="usage-stat-label">Total Time</span>
              </div>
              <div class="usage-stat cost-estimate">
                <span class="usage-stat-value" id="usageEstCost">$0.00</span>
                <span class="usage-stat-label">Est. Cost</span>
              </div>
            </div>
          </div>

          <div class="progress-section" id="errorSection" style="display: none;">
            <div class="progress-label">Last Error</div>
            <div class="error-display" id="errorDisplay"></div>
          </div>

          <div class="progress-actions">
            <button class="btn" id="refreshProgressBtn" title="Reload build progress and stats">Refresh</button>
          </div>
        </div>
        <div class="tab-pane" id="tab-processes">
          <div class="tab-title">Processes</div>
          <div class="tab-description">Manage background processes (npm run dev, tsc --watch, etc.)</div>
          <div class="process-spawn-form">
            <input type="text" class="process-input" id="processCommandInput" placeholder="npm run dev" title="Enter command to run (e.g., npm run dev, tsc --watch)" autocomplete="off">
            <button class="process-spawn-btn" id="processSpawnBtn" title="Start the background process">Start</button>
          </div>
          <div class="process-list" id="processList">
            <div class="process-empty">No processes running</div>
          </div>
        </div>

        <!-- P2-5: Message Inspector Tab -->
        <div class="tab-pane" id="tab-inspector">
          <div class="tab-title">Message Inspector</div>
          <div class="tab-description">Debug message flow, delivery status, and sequence tracking</div>

          <!-- Stats summary -->
          <div class="inspector-stats">
            <div class="inspector-stat">
              <span class="inspector-stat-value" id="inspectorTotalEvents">0</span>
              <span class="inspector-stat-label">Events</span>
            </div>
            <div class="inspector-stat success">
              <span class="inspector-stat-value" id="inspectorDelivered">0</span>
              <span class="inspector-stat-label">Delivered</span>
            </div>
            <div class="inspector-stat warning">
              <span class="inspector-stat-value" id="inspectorPending">0</span>
              <span class="inspector-stat-label">Pending</span>
            </div>
            <div class="inspector-stat error">
              <span class="inspector-stat-value" id="inspectorSkipped">0</span>
              <span class="inspector-stat-label">Skipped</span>
            </div>
          </div>

          <!-- Filter controls -->
          <div class="inspector-controls">
            <div class="inspector-filters">
              <button class="inspector-filter active" data-filter="all" title="Show all events">All</button>
              <button class="inspector-filter" data-filter="trigger" title="Trigger file events">Triggers</button>
              <button class="inspector-filter" data-filter="broadcast" title="Broadcast messages">Broadcast</button>
              <button class="inspector-filter" data-filter="sdk" title="SDK mode events">SDK</button>
              <button class="inspector-filter" data-filter="blocked" title="Blocked/skipped messages">Blocked</button>
            </div>
            <div class="inspector-toggle">
              <label class="inspector-toggle-label">
                <input type="checkbox" id="inspectorAutoScroll" checked>
                Auto-scroll
              </label>
              <label class="inspector-toggle-label">
                <input type="checkbox" id="inspectorPaused">
                Pause
              </label>
            </div>
          </div>

          <!-- Event log -->
          <div class="inspector-log" id="inspectorLog">
            <div class="inspector-empty">No events captured yet. Trigger files or send messages to see activity.</div>
          </div>

          <!-- Actions -->
          <div class="inspector-actions">
            <button class="btn" id="refreshInspectorBtn" title="Reload sequence state">Refresh State</button>
            <button class="btn" id="clearInspectorBtn" title="Clear event log">Clear Log</button>
            <button class="btn" id="exportInspectorBtn" title="Export log to file">Export</button>
          </div>

          <!-- Sequence state display -->
          <div class="inspector-section">
            <div class="inspector-section-title">Sequence Tracking State</div>
            <div class="inspector-sequence-grid" id="inspectorSequenceGrid">
              <div class="inspector-sequence-item" data-agent="lead">
                <span class="inspector-seq-name">Architect</span>
                <span class="inspector-seq-value" id="seq-lead">-</span>
              </div>
              <div class="inspector-sequence-item" data-agent="orchestrator">
                <span class="inspector-seq-name">Infra</span>
                <span class="inspector-seq-value" id="seq-orchestrator">-</span>
              </div>
              <div class="inspector-sequence-item" data-agent="worker-a">
                <span class="inspector-seq-name">Frontend</span>
                <span class="inspector-seq-value" id="seq-worker-a">-</span>
              </div>
              <div class="inspector-sequence-item" data-agent="worker-b">
                <span class="inspector-seq-name">Backend</span>
                <span class="inspector-seq-value" id="seq-worker-b">-</span>
              </div>
              <div class="inspector-sequence-item" data-agent="investigator">
                <span class="inspector-seq-name">Analyst</span>
                <span class="inspector-seq-value" id="seq-investigator">-</span>
              </div>
              <div class="inspector-sequence-item" data-agent="reviewer">
                <span class="inspector-seq-name">Reviewer</span>
                <span class="inspector-seq-value" id="seq-reviewer">-</span>
              </div>
            </div>
          </div>

          <!-- Task #8: Reliability Analytics Section -->
          <div class="inspector-section">
            <div class="inspector-section-title">Reliability Analytics</div>
            <div class="reliability-overview">
              <div class="reliability-stat primary">
                <span class="reliability-stat-value" id="reliabilitySuccessRate">--%</span>
                <span class="reliability-stat-label">Success Rate</span>
              </div>
              <div class="reliability-stat">
                <span class="reliability-stat-value" id="reliabilityUptime">--</span>
                <span class="reliability-stat-label">Uptime</span>
              </div>
              <div class="reliability-stat">
                <span class="reliability-stat-value" id="reliabilityLatency">--ms</span>
                <span class="reliability-stat-label">Avg Latency</span>
              </div>
            </div>
            <div class="reliability-details">
              <div class="reliability-row">
                <span class="reliability-row-label">Total Sent:</span>
                <span class="reliability-row-value" id="reliabilitySent">0</span>
              </div>
              <div class="reliability-row">
                <span class="reliability-row-label">Delivered:</span>
                <span class="reliability-row-value success" id="reliabilityDelivered">0</span>
              </div>
              <div class="reliability-row">
                <span class="reliability-row-label">Failed:</span>
                <span class="reliability-row-value error" id="reliabilityFailed">0</span>
              </div>
              <div class="reliability-row">
                <span class="reliability-row-label">Timed Out:</span>
                <span class="reliability-row-value warning" id="reliabilityTimedOut">0</span>
              </div>
              <div class="reliability-row">
                <span class="reliability-row-label">Skipped (dup):</span>
                <span class="reliability-row-value" id="reliabilitySkipped">0</span>
              </div>
            </div>
            <div class="reliability-modes">
              <div class="reliability-mode-card">
                <div class="reliability-mode-title">PTY Mode</div>
                <div class="reliability-mode-stats">
                  <span id="reliabilityPtySent">0</span> sent /
                  <span id="reliabilityPtyDelivered">0</span> delivered
                </div>
              </div>
              <div class="reliability-mode-card">
                <div class="reliability-mode-title">SDK Mode</div>
                <div class="reliability-mode-stats">
                  <span id="reliabilitySdkSent">0</span> sent /
                  <span id="reliabilitySdkDelivered">0</span> delivered
                </div>
              </div>
            </div>
            <div class="reliability-windows">
              <div class="reliability-window">
                <span class="reliability-window-label">Last 15m:</span>
                <span id="reliability15m">--</span>
              </div>
              <div class="reliability-window">
                <span class="reliability-window-label">Last 1h:</span>
                <span id="reliability1h">--</span>
              </div>
            </div>
            <button class="btn" id="refreshReliabilityBtn" title="Refresh reliability stats">Refresh Stats</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="status-bar">
    <span id="connectionStatus">Initializing...</span>
    <span id="heartbeatIndicator" class="heartbeat-indicator idle" style="display: none;">HB: IDLE (10m)</span>
    <span>Press Ctrl+1-6 to focus pane | Enter to send to Lead | /all to broadcast | /3 to target pane 3</span>
  </div>

  <script src="renderer.js"></script>
</body>
</html>
